<?xml version="1.0" encoding="utf-8"?> <!-- -*- nxml -*- -->
<transfer default="chunk">
  <section-def-cats>
    <def-cat n="nom">
      <cat-item tags="n.*"/>
    </def-cat>
    <def-cat n="adj">
      <cat-item tags="adj.m.*"/>
      <cat-item tags="adj.f.*"/>
      <cat-item tags="adj.mf.*"/>
      <cat-item tags="adj.GD.*"/>
      <cat-item tags="adj.ind.*"/>
      <cat-item tags="adj.ord.*"/>
      <cat-item tags="adj.pos.*"/>
      <cat-item tags="adj.itg.*"/>
    </def-cat>
    <def-cat n="adjsup">
      <cat-item tags="adj.sup.*"/>
    </def-cat>
    <def-cat n="adjec">
      <cat-item tags="adj.*"/>
      <cat-item tags="vblex.pp.*"/>
    </def-cat>
    <def-cat n="adj_adv">
      <cat-item tags="adj.*"/>
      <cat-item tags="adv"/>
    </def-cat>
    <def-cat n="adjec_adv">
      <cat-item tags="adj.*"/>
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="adv"/>
    </def-cat>
    <def-cat n="soli">
      <cat-item lemma="solo" tags="adj.m.pl"/>
      <cat-item lemma="solo" tags="adj.f.pl"/>
    </def-cat>
    <def-cat n="solito">
      <cat-item lemma="solito" tags="adj.*"/>
    </def-cat>

    <def-cat n="adv_preadv">
      <cat-item tags="adv"/>
      <cat-item tags="preadv"/>
    </def-cat>
    <def-cat n="adv">
      <cat-item tags="adv"/>
    </def-cat>
    <def-cat n="piu_meno">
      <cat-item lemma="più" tags="adv"/>
      <cat-item lemma="meno" tags="adv"/>
      <cat-item lemma="molto più" tags="adv"/>
      <cat-item lemma="molto meno" tags="adv"/>
    </def-cat>

    <def-cat n="pp">
      <cat-item tags="vblex.pp.*"/>
      <cat-item tags="vbmod.pp.*"/>
      <cat-item tags="vbhaver.pp.*"/>
      <cat-item tags="vbser.pp.*"/>
    </def-cat>
   <def-cat n="vbser_pp">
      <cat-item tags="vbser.pp.*"/>
      <cat-item lemma="stare" tags="vblex.pp.*"/>
   </def-cat>

   <def-cat n="vbser">
      <cat-item tags="vbser.*"/>
   </def-cat>
   <def-cat n="vbaux">
      <cat-item tags="vbser.*"/>
      <cat-item tags="vbhaver.*"/>
    </def-cat>

    <def-cat n="inf">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vbmod.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbser.inf"/>
    </def-cat>

    <def-cat n="ger">
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vbmod.ger"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbser.ger"/>
    </def-cat>

    <def-cat n="inf_ger">
      <cat-item tags="vblex.inf"/>
      <cat-item tags="vbmod.inf"/>
      <cat-item tags="vbhaver.inf"/>
      <cat-item tags="vbser.inf"/>
      <cat-item tags="vblex.ger"/>
      <cat-item tags="vbmod.ger"/>
      <cat-item tags="vbhaver.ger"/>
      <cat-item tags="vbser.ger"/>
    </def-cat>

    <def-cat n="imp">
      <cat-item tags="vblex.imp.*"/>
      <cat-item tags="vbmod.imp.*"/>
      <cat-item tags="vbhaver.imp.*"/>
      <cat-item tags="vbser.imp.*"/>
    </def-cat>

    <def-cat n="pprs">
      <cat-item tags="vblex.pprs.*"/>
      <cat-item tags="vbmod.pprs.*"/>
      <cat-item tags="vbhaver.pprs.*"/>
      <cat-item tags="vbser.pprs.*"/>
    </def-cat>

    <def-cat n="vfin_no_ifi">
      <cat-item tags="vblex.pri.*"/>
      <cat-item tags="vblex.pii.*"/>
      <cat-item tags="vblex.prs.*"/>
      <cat-item tags="vblex.fti.*"/>
      <cat-item tags="vblex.pis.*"/>
      <cat-item tags="vblex.cni.*"/>
      <cat-item tags="vbmod.pri.*"/>
      <cat-item tags="vbmod.pii.*"/>
      <cat-item tags="vbmod.prs.*"/>
      <cat-item tags="vbmod.fti.*"/>
      <cat-item tags="vbmod.cni.*"/>
      <cat-item tags="vbmod.pis.*"/>
      <cat-item tags="vbser.pri.*"/>
      <cat-item tags="vbser.pii.*"/>
      <cat-item tags="vbser.prs.*"/>
      <cat-item tags="vbser.fti.*"/>
      <cat-item tags="vbser.pis.*"/>
      <cat-item tags="vbser.cni.*"/>
    </def-cat>

    <def-cat n="vlexfin_no_ifi">
      <cat-item tags="vblex.pri.*"/>
      <cat-item tags="vblex.pii.*"/>
      <cat-item tags="vblex.prs.*"/>
      <cat-item tags="vblex.fti.*"/>
      <cat-item tags="vblex.pis.*"/>
      <cat-item tags="vblex.cni.*"/>
    </def-cat>

    <def-cat n="pretind">
      <cat-item tags="vblex.ifi.*"/>
      <cat-item tags="vbser.ifi.*"/>
      <cat-item tags="vbmod.ifi.*"/>
    </def-cat>

    <def-cat n="ser_p3_ifi">
      <cat-item tags="vbser.ifi.p3.sg"/>
      <cat-item tags="vbser.ifi.p3.pl"/>
    </def-cat>

    <def-cat n="ser_p3_no_ifi">
      <cat-item tags="vbser.pri.p3.sg"/>
      <cat-item tags="vbser.pii.p3.sg"/>
      <cat-item tags="vbser.prs.p3.sg"/>
      <cat-item tags="vbser.fti.p3.sg"/>
      <cat-item tags="vbser.pis.p3.sg"/>
      <cat-item tags="vbser.cni.p3.sg"/>
      <cat-item tags="vbser.pri.p3.pl"/>
      <cat-item tags="vbser.pii.p3.pl"/>
      <cat-item tags="vbser.prs.p3.pl"/>
      <cat-item tags="vbser.fti.p3.pl"/>
      <cat-item tags="vbser.pis.p3.pl"/>
      <cat-item tags="vbser.cni.p3.pl"/>
    </def-cat>

    <def-cat n="ser_p3sg_no_ifi">
      <cat-item tags="vbser.pri.p3.sg"/>
      <cat-item tags="vbser.pii.p3.sg"/>
      <cat-item tags="vbser.prs.p3.sg"/>
      <cat-item tags="vbser.fti.p3.sg"/>
      <cat-item tags="vbser.pis.p3.sg"/>
      <cat-item tags="vbser.cni.p3.sg"/>
    </def-cat>

    <def-cat n="ser_p3pl_no_ifi">
      <cat-item tags="vbser.pri.p3.pl"/>
      <cat-item tags="vbser.pii.p3.pl"/>
      <cat-item tags="vbser.prs.p3.pl"/>
      <cat-item tags="vbser.fti.p3.pl"/>
      <cat-item tags="vbser.pis.p3.pl"/>
      <cat-item tags="vbser.cni.p3.pl"/>
    </def-cat>

    <def-cat n="volere_p3sg_no_ifi">
      <cat-item lemma="volere" tags="vbmod.pri.p3.sg"/>
      <cat-item lemma="volere" tags="vbmod.pii.p3.sg"/>
      <cat-item lemma="volere" tags="vbmod.prs.p3.sg"/>
      <cat-item lemma="volere" tags="vbmod.fti.p3.sg"/>
      <cat-item lemma="volere" tags="vbmod.pis.p3.sg"/>
      <cat-item lemma="volere" tags="vbmod.cni.p3.sg"/>
    </def-cat>

    <def-cat n="fa">
      <cat-item lemma="fare" tags="vblex.pri.p3.sg"/>
    </def-cat>

    <def-cat n="andare">
      <cat-item lemma="andare" tags="vblex.*"/>
    </def-cat>

    <def-cat n="andare_no_ifi">
      <cat-item tags="vblex.pri.*"/>
      <cat-item tags="vblex.pii.*"/>
      <cat-item tags="vblex.prs.*"/>
      <cat-item tags="vblex.fti.*"/>
      <cat-item tags="vblex.pis.*"/>
      <cat-item tags="vblex.cni.*"/>
    </def-cat>

    <def-cat n="andare_ifi">
      <cat-item tags="vblex.ifi.*"/>
    </def-cat>

    <def-cat n="bisognare">
      <cat-item lemma="bisognare" tags="vbmod.*"/>
    </def-cat>

    <def-cat n="prn">
      <cat-item tags="prn.*"/>
    </def-cat>
    <def-cat n="prnenc">
      <cat-item tags="prn.enc.*"/>
    </def-cat>
    <def-cat n="prnpro">
      <cat-item tags="prn.pro.*"/>
    </def-cat>
    <def-cat n="ci">
      <cat-item lemma="ci" tags="prn.pro.adv"/>
      <cat-item lemma="vi" tags="prn.pro.adv"/>
    </def-cat>
    <def-cat n="si">
      <cat-item lemma="si" tags="prn.pro.ref.p3.mf.sp"/>
    </def-cat>
    <def-cat n="tutto_prn">
      <cat-item lemma="tutto" tags="prn.*"/>
    </def-cat>
    <def-cat n="prnpers_subj">
      <cat-item lemma="io" tags="prn.tn.*"/>
      <cat-item lemma="tu" tags="prn.tn.*"/>
      <cat-item lemma="lui" tags="prn.tn.*"/>
      <cat-item lemma="lei" tags="prn.tn.*"/>
      <cat-item lemma="noi" tags="prn.tn.*"/>
      <cat-item lemma="voi" tags="prn.tn.*"/>
      <cat-item lemma="loro" tags="prn.tn.*"/>
    </def-cat>
    <def-cat n="lui_mf_pl">
      <cat-item lemma="lui" tags="prn.tn.p3.mf.pl"/>
    </def-cat>
    <def-cat n="quello">			<!-- REVISAR -->
      <cat-item lemma="quello" tags="prn.tn.*"/>
      <cat-item lemma="quello" tags="det.dem.*"/>
    </def-cat>

    <def-cat n="np">
      <cat-item tags="np.*"/>
    </def-cat>

    <def-cat n="top">
      <cat-item tags="np.top.*"/>
      <cat-item tags="np.hyd.*"/>
      <cat-item tags="np.loc"/>
    </def-cat>

    <def-cat n="org">
      <cat-item tags="np.org.*"/>
      <cat-item tags="np.al.*"/>
<!--      <cat-item tags="np.al"/>  no es pot posar perquè no pot coordinar en gènere i nombre -->
    </def-cat>

    <def-cat n="top_ant">
      <cat-item tags="np.ant.*"/>
      <cat-item tags="np.cog.*"/>
    </def-cat>

    <def-cat n="det">          
      <cat-item tags="det.*"/>
      <cat-item tags="predet.*"/>
    </def-cat>
    <def-cat n="predet">
      <cat-item tags="predet.*"/>
    </def-cat>
    <def-cat n="det_def">          
      <cat-item tags="det.def.*"/>
    </def-cat>
    <def-cat n="il_msg">          
      <cat-item tags="det.def.m.sg"/>
    </def-cat>

    <def-cat n="num">
      <cat-item tags="num.*"/>
      <cat-item tags="num"/>
    </def-cat>
    <def-cat n="giorno">
      <cat-item tags="num"/>
      <cat-item lemma="1º" tags="adj.ord.m.sg"/>
    </def-cat>
    <def-cat n="anno">
      <cat-item tags="num"/>
    </def-cat>

    <def-cat n="num_det_adj">
      <cat-item tags="num.*"/>
      <cat-item tags="num"/>
      <cat-item tags="det.*"/>
      <cat-item tags="adj.*"/>
    </def-cat>

    <def-cat n="cnjcoo">
      <cat-item tags="cnjcoo"/>
    </def-cat>

    <def-cat n="cnjsub">
      <cat-item tags="cnjsub"/>
    </def-cat>
    
    <def-cat n="cnjadv">
      <cat-item tags="cnjadv"/>
    </def-cat>
    
    <def-cat n="pr">
      <cat-item tags="pr"/>
    </def-cat>
    <def-cat n="da">
      <cat-item lemma="da" tags="pr"/>
    </def-cat>
    <def-cat n="di">
      <cat-item lemma="di" tags="pr"/>
    </def-cat>
    <def-cat n="in">
      <cat-item lemma="in" tags="pr"/>
    </def-cat>
    
    <def-cat n="rel">
      <cat-item tags="rel.*"/>
    </def-cat>

    <def-cat n="mese">
       <cat-item lemma="gennaio" tags="n.*"/>
       <cat-item lemma="febbraio" tags="n.*"/>
       <cat-item lemma="marzo" tags="n.*"/>
       <cat-item lemma="aprile" tags="n.*"/>
       <cat-item lemma="maggio" tags="n.*"/>
       <cat-item lemma="giugno" tags="n.*"/>
       <cat-item lemma="luglio" tags="n.*"/>
       <cat-item lemma="agosto" tags="n.*"/>
       <cat-item lemma="settembre" tags="n.*"/>
       <cat-item lemma="ottobre" tags="n.*"/>
       <cat-item lemma="novembre" tags="n.*"/>
       <cat-item lemma="dicembre" tags="n.*"/>
    </def-cat>

    <def-cat n="stagione">
       <cat-item lemma="primavera" tags="n.*"/>
       <cat-item lemma="estate" tags="n.*"/>
       <cat-item lemma="autunno" tags="n.*"/>
       <cat-item lemma="inverno" tags="n.*"/>
    </def-cat>

    <def-cat n="secolo">
       <cat-item lemma="secolo" tags="n.*"/>
    </def-cat>
    <def-cat n="secolo_sg">
       <cat-item lemma="secolo" tags="n.m.sg"/>
    </def-cat>
    <def-cat n="num_romano"> <!-- algun error fa que els lemes s'hagin de posar en minúscules, o bé no es reconeixen -->
       <cat-item lemma="i" tags="num.*"/>
       <cat-item lemma="ii" tags="num.*"/>
       <cat-item lemma="iii" tags="num.*"/>
       <cat-item lemma="iv" tags="num.*"/>
       <cat-item lemma="v" tags="num.*"/>
       <cat-item lemma="vi" tags="num.*"/>
       <cat-item lemma="vii" tags="num.*"/>
       <cat-item lemma="viii" tags="num.*"/>
       <cat-item lemma="ix" tags="num.*"/>
       <cat-item lemma="x" tags="num.*"/>
       <cat-item lemma="xi" tags="num.*"/>
       <cat-item lemma="xii" tags="num.*"/>
       <cat-item lemma="xiii" tags="num.*"/>
       <cat-item lemma="xiv" tags="num.*"/>
       <cat-item lemma="xv" tags="num.*"/>
       <cat-item lemma="xvi" tags="num.*"/>
       <cat-item lemma="xvii" tags="num.*"/>
       <cat-item lemma="xviii" tags="num.*"/>
       <cat-item lemma="xix" tags="num.*"/>
       <cat-item lemma="xx" tags="num.*"/>
       <cat-item lemma="xxi" tags="num.*"/>
       <cat-item lemma="xxi" tags="num.*"/>
       <cat-item lemma="xxii" tags="num.*"/>
       <cat-item lemma="xxiii" tags="num.*"/>
       <cat-item lemma="xxiv" tags="num.*"/>
       <cat-item lemma="xxv" tags="num.*"/>
       <cat-item lemma="xxvi" tags="num.*"/>
       <cat-item lemma="xxvii" tags="num.*"/>
       <cat-item lemma="xxviii" tags="num.*"/>
       <cat-item lemma="xxix" tags="num.*"/>
       <cat-item lemma="xxx" tags="num.*"/>
    </def-cat>
    <def-cat n="periodo">
       <cat-item lemma="secondo" tags="n.*"/>
       <cat-item lemma="minuto" tags="n.*"/>
       <cat-item lemma="ora" tags="n.*"/>
       <cat-item lemma="giorno" tags="n.*"/>
       <cat-item lemma="settimana" tags="n.*"/>
       <cat-item lemma="mese" tags="n.*"/>
       <cat-item lemma="anno" tags="n.*"/>
       <cat-item lemma="secolo" tags="n.*"/>
       <cat-item lemma="millennio" tags="n.*"/>
    </def-cat>

    <def-cat n="sent">
       <cat-item lemma="." tags="sent"/>
    </def-cat>
    <def-cat n="final_sent">
       <cat-item lemma="." tags="sent"/>
       <cat-item lemma="?" tags="sent"/>
       <cat-item lemma="!" tags="sent"/>
    </def-cat>
  </section-def-cats>

  <section-def-attrs>
    <def-attr n="a_verb">
      <attr-item tags="vblex"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbmod"/>
      <attr-item tags="vaux"/>
    </def-attr>

    <def-attr n="a_verb_pron">
      <attr-item tags="vblex"/>
      <attr-item tags="vblex.pron"/>
      <attr-item tags="vbser"/>
      <attr-item tags="vbhaver"/>
      <attr-item tags="vbmod"/>
      <attr-item tags="vaux"/>
    </def-attr>

    <def-attr n="a_adj">
      <attr-item tags="adj"/>
      <attr-item tags="adj.ind"/>
      <attr-item tags="adj.itg"/>
      <attr-item tags="adj.ord"/>
      <attr-item tags="adj.pos"/>
      <attr-item tags="adj.qnt"/>
      <attr-item tags="adj.sup"/>
      <attr-item tags="adj.ind.sup"/>
      <attr-item tags="det.ind"/> <!-- poco / poc -->
      <attr-item tags="vblex.pp"/>
    </def-attr>

    <def-attr n="a_nom">
      <attr-item tags="n"/>
      <attr-item tags="n.acr"/>
      <attr-item tags="n.unc"/>
      <attr-item tags="np.top"/>
      <attr-item tags="np.hyd"/>
      <attr-item tags="np.al"/>
      <attr-item tags="np.org"/>
      <attr-item tags="np.ant"/>
      <attr-item tags="np.cog"/>
    </def-attr>

    <def-attr n="a_det">          
      <attr-item tags="det.def"/>
      <attr-item tags="det.ind"/>
      <attr-item tags="det.dem"/>
      <attr-item tags="det.pos"/>
      <attr-item tags="adj"/> <!-- poco / poc -->
      <attr-item tags="adj.ind"/>
      <attr-item tags="predet"/>
    </def-attr>

    <def-attr n="a_adv">
      <attr-item tags="adv"/>
      <attr-item tags="preadv"/>
    </def-attr>
   
    <def-attr n="a_num">
      <attr-item tags="num"/>
      <attr-item tags="num.percent"/>
    </def-attr>

    <def-attr n="tipus_prn">
      <attr-item tags="prn.tn.pos"/>
      <attr-item tags="prn.tn.ref"/>
      <attr-item tags="prn.tn"/>
      <attr-item tags="prn.itg"/>
      <attr-item tags="prn.pro"/>
      <attr-item tags="prn.pro.adv"/>
      <attr-item tags="prn.pro.ref"/>
      <attr-item tags="prn.enc"/>
      <attr-item tags="prn.enc.adv"/>
      <attr-item tags="prn.enc.ref"/>
      <attr-item tags="prn.dem"/>
      <attr-item tags="prn.ind"/>
      <attr-item tags="prn.pos"/>
      <attr-item tags="prn.enc"/>
    </def-attr>


    <def-attr n="pers">
      <attr-item tags="p1"/>
      <attr-item tags="p2"/>
      <attr-item tags="p3"/>
    </def-attr>


    <def-attr n="temps">
      <attr-item tags="inf"/>
      <attr-item tags="ger"/>
      <attr-item tags="pp"/>
      <attr-item tags="pri"/>
      <attr-item tags="ifi"/>
      <attr-item tags="pii"/>
      <attr-item tags="fti"/>
      <attr-item tags="cni"/>
      <attr-item tags="prs"/>
      <attr-item tags="pis"/>
      <attr-item tags="fts"/>
      <attr-item tags="imp"/>
    </def-attr>


    <def-attr n="gen">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="mf"/>
      <attr-item tags="GD"/>
      <attr-item tags="nt"/>
    </def-attr>

    <def-attr n="gen_sense_mf">
      <attr-item tags="m"/>
      <attr-item tags="f"/>
      <attr-item tags="GD"/>
      <attr-item tags="nt"/>
    </def-attr>

    <def-attr n="gen_mf">
      <attr-item tags="mf"/>
    </def-attr>

    <def-attr n="nbr">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="sp"/>
      <attr-item tags="ND"/>
    </def-attr>

    <def-attr n="nbr_sense_sp">
      <attr-item tags="sg"/>
      <attr-item tags="pl"/>
      <attr-item tags="ND"/>
    </def-attr>

    <def-attr n="nbr_sp">
      <attr-item tags="sp"/>
    </def-attr>

  </section-def-attrs>

  <section-def-vars>
    <def-var n="verbfinal"/>
    <def-var n="numerodia"/>
    <def-var n="caseFirstWord"/>
    <def-var n="concPrimero"/>
    <def-var n="concSegundo"/>
    <def-var n="concTercero"/>
    <def-var n="lemma"/>
    <def-var n="pronom"/>
    <def-var n="EOS" v="&lt;true&gt;"/>

    <def-var n="numero" v="&lt;sg&gt;"/>
    <def-var n="genero" v="&lt;m&gt;"/>
    <def-var n="numero_aux" v="&lt;sg&gt;"/>
    <def-var n="genero_aux" v="&lt;m&gt;"/>
    <def-var n="numero_sl" v="&lt;sg&gt;"/>
    <def-var n="genero_sl" v="&lt;m&gt;"/>

    <def-var n="debug1"/>
    <def-var n="debug2"/>
    <def-var n="debug3"/>
  </section-def-vars>

  <section-def-lists>
    <def-list n="vbambser">
      <list-item v="accorrere"/>
      <list-item v="addivenire"/>
      <list-item v="affiorare"/>
      <list-item v="allibire"/>
      <list-item v="ammattire"/>
      <list-item v="ammuffire"/>
      <list-item v="andare"/>
      <list-item v="apparire"/>
      <list-item v="arrivare"/>
      <list-item v="arrossire"/>
      <list-item v="assurgere"/>
      <list-item v="avvenire"/>
      <list-item v="avvizzire"/>
      <list-item v="balenare"/>
      <list-item v="bastare"/>
      <list-item v="cadere"/>
      <list-item v="capitare"/>
      <list-item v="cascare"/>
      <list-item v="comparire"/>
      <list-item v="costare"/>
      <list-item v="crollare"/>
      <list-item v="decadere"/>
      <list-item v="decedere"/>
      <list-item v="decorrere"/>
      <list-item v="decrescere"/>
      <list-item v="defungere"/>
      <list-item v="dimagrire"/>
      <list-item v="dipendere"/>
      <list-item v="dispiacere"/>
      <list-item v="divenire"/>
      <list-item v="diventare"/>
      <list-item v="durare"/>
      <list-item v="emergere"/>
      <list-item v="entrare"/>
      <list-item v="esistere"/>
      <list-item v="essere"/>
      <list-item v="giacere"/>
      <list-item v="giungere"/>
      <list-item v="implodere"/>
      <list-item v="incorrere"/>
      <list-item v="insorgere"/>
      <list-item v="insorgere"/>
      <list-item v="intervenire"/>
      <list-item v="morire"/>
      <list-item v="nascere"/>
      <list-item v="occorrere"/>
      <list-item v="parere"/>
      <list-item v="partire"/>
      <list-item v="permanere"/>
      <list-item v="piacere"/>
      <list-item v="provenire"/>
      <list-item v="restare"/>
      <list-item v="ricadere"/>
      <list-item v="rimanere"/>
      <list-item v="risorgere"/>
      <list-item v="risultare"/>
      <list-item v="ritornare"/>
      <list-item v="riuscire"/>
      <list-item v="sbucare"/>
      <list-item v="scadere"/>
      <list-item v="scappare"/>
      <list-item v="scomparire"/>
      <list-item v="sembrare"/>
      <list-item v="sfuggire"/>
      <list-item v="sparire"/>
      <list-item v="sopraggiungere"/>
      <list-item v="sopravvenire"/>
      <list-item v="sorgere"/>
      <list-item v="sovvenire"/>
      <list-item v="spiacere"/>
      <list-item v="stare"/>
      <list-item v="sussistere"/>
      <list-item v="svanire"/>
      <list-item v="svenire"/>
      <list-item v="tornare"/>
      <list-item v="uscire"/>
      <list-item v="valere"/>
      <list-item v="venire"/>

      <list-item v="accedere"/>
      <list-item v="allunare"/>
      <list-item v="ammarare"/>
      <list-item v="annottare"/>
      <list-item v="appartenere"/>
      <list-item v="approdare"/>
      <list-item v="arretrare"/>
      <list-item v="assomigliare"/>
      <list-item v="attecchire"/>
      <list-item v="atterrare"/>
      <list-item v="brillare"/>
      <list-item v="calzare"/>
      <list-item v="campare"/>
      <list-item v="coincidere"/>
      <list-item v="combaciare"/>
      <list-item v="confluire"/>
      <list-item v="convivere"/>
      <list-item v="culminare"/>
      <list-item v="debordare"/>
      <list-item v="decollare"/>
      <list-item v="defluire"/>
      <list-item v="degenerare"/>
      <list-item v="deragliare"/>
      <list-item v="dilagare"/>
      <list-item v="diluviare"/>
      <list-item v="emigrare"/>
      <list-item v="equivalere"/>
      <list-item v="espatriare"/>
      <list-item v="figurare"/>
      <list-item v="fioccare"/>
      <list-item v="garbare"/>
      <list-item v="germinare"/>
      <list-item v="germogliare"/>
      <list-item v="grandinare"/>
      <list-item v="incespicare"/>
      <list-item v="inciampare"/>
      <list-item v="indietreggiare"/>
      <list-item v="inorridire"/>
      <list-item v="lampeggiare"/>
      <list-item v="luccicare"/>
      <list-item v="marcire"/>
      <list-item v="maturare"/>
      <list-item v="migliorare"/>
      <list-item v="naufragare"/>
      <list-item v="nevicare"/>
      <list-item v="piovere"/>
      <list-item v="prevalere"/>
      <list-item v="procedere"/>
      <list-item v="rabbrividire"/>
      <list-item v="rimpatriare"/>
      <list-item v="risaltare"/>
      <list-item v="risuonare"/>
      <list-item v="scivolare"/>
      <list-item v="somigliare"/>
      <list-item v="sventolare"/>
      <list-item v="tramontare"/>
      <list-item v="vivere"/>
      <list-item v="zampillare"/>

      <list-item v="accelerare"/>
      <list-item v="accrescere"/>
      <list-item v="affievolire"/>
      <list-item v="affogare"/>
      <list-item v="affondare"/>
      <list-item v="agghiacciare"/>
      <list-item v="ammutolire"/>
      <list-item v="annegare"/>
      <list-item v="annerire"/>
      <list-item v="ardere"/>
      <list-item v="arretrare"/>
      <list-item v="arricchire"/>
      <list-item v="arrugginire"/>
      <list-item v="asfissiare"/>
      <list-item v="aumentare"/>
      <list-item v="avanzare"/>
      <list-item v="azzittire"/>
      <list-item v="bruciare"/>
      <list-item v="calare"/>
      <list-item v="calzare"/>
      <list-item v="cambiare"/>
      <list-item v="centuplicare"/>
      <list-item v="cessare"/>
      <list-item v="cicatrizzare"/>
      <list-item v="colare"/>
      <list-item v="cominciare"/>
      <list-item v="continuare"/>
      <list-item v="convenire"/>
      <list-item v="correre"/>
      <list-item v="crepare"/>
      <list-item v="crescere"/>
      <list-item v="declinare"/>
      <list-item v="derivare"/>
      <list-item v="deviare"/>
      <list-item v="diminuire"/>
      <list-item v="discendere"/>
      <list-item v="evadere"/>
      <list-item v="esplodere"/>
      <list-item v="fallire"/>
      <list-item v="finire"/>
      <list-item v="fuggire"/>
      <list-item v="gelare"/>
      <list-item v="guarire"/>
      <list-item v="importare"/>
      <list-item v="ingrassare"/>
      <list-item v="invecchiare"/>
      <list-item v="mancare"/>
      <list-item v="maturare"/>
      <list-item v="migliorare"/>
      <list-item v="montare"/>
      <list-item v="mutare"/>
      <list-item v="passare"/>
      <list-item v="peggiorare"/>
      <list-item v="pesare"/>
      <list-item v="resuscitare"/>
      <list-item v="rincarare"/>
      <list-item v="ringiovanire"/>
      <list-item v="salire"/>
      <list-item v="saltare"/>
      <list-item v="sbarcare"/>
      <list-item v="scattare"/>
      <list-item v="scendere"/>
      <list-item v="schizzare"/>
      <list-item v="scorrere"/>
      <list-item v="seguire"/>
      <list-item v="servire"/>
      <list-item v="sfumare"/>
      <list-item v="suonare"/>
      <list-item v="toccare"/>
      <list-item v="trascorrere"/>
      <list-item v="variare"/>
    </def-list>

    <def-list n="paisos_regions"> <!-- per a treure un article si el porten -->
      <list-item v="Europa"/>
      <list-item v="Asia"/>
      <list-item v="Africa"/>
      <list-item v="Africa del Sud"/>
      <list-item v="America"/>
      <list-item v="America Centrale"/>
      <list-item v="America del Nord"/>
      <list-item v="America del Sud"/>
      <list-item v="Nord America"/>
      <list-item v="Nord-America"/>
      <list-item v="Sud America"/>
      <list-item v="Sud-America"/>
      <list-item v="Oceania"/>
      <list-item v="Scandinavia"/>
      <list-item v="Afganistan"/>
      <list-item v="Algeria"/>
      <list-item v="Angola"/>
      <list-item v="Antigua e Barbuda"/>
      <list-item v="Arabia"/>
      <list-item v="Arabia Saudita"/>
<!--      <list-item v="Argentina"/> -->
      <list-item v="Armenia"/>
      <list-item v="Australia"/>
      <list-item v="Austria"/>
      <list-item v="Azerbaigian"/>
      <list-item v="Bahamas"/>
      <list-item v="Bahrain"/>
      <list-item v="Bangladesh"/>
      <list-item v="Barbados"/>
      <list-item v="Belgio"/>
      <list-item v="Belize"/>
      <list-item v="Benin"/>
      <list-item v="Bhutan"/>
      <list-item v="Bielorussia"/>
      <list-item v="Bolivia"/>
      <list-item v="Borneo"/>
      <list-item v="Botswana"/>
<!--      <list-item v="Brasile"/>  -->
      <list-item v="Gran Bretagna"/>
      <list-item v="Brunei"/>
      <list-item v="Bulgaria"/>
      <list-item v="Burkina Faso"/>
      <list-item v="Burundi"/>
      <list-item v="Capo Verde"/>
      <list-item v="Nuova Caledonia"/>
      <list-item v="Camerun"/>
<!--      <list-item v="Canada"/>  -->
      <list-item v="Sulawesi"/>
<!--      <list-item v="Ciad"/> -->
      <list-item v="Colombia"/>
      <list-item v="Comore"/>
<!--      <list-item v="Congo"/> -->
      <list-item v="Corea"/>
      <list-item v="Corea del Nord"/>
      <list-item v="Corea del Sud"/>
      <list-item v="Costa d'Avorio"/>
      <list-item v="Costa Rica"/>
      <list-item v="Cuba"/>
      <list-item v="Danimarca"/>
      <list-item v="Dominica"/>
      <list-item v="Ecuador"/>
      <list-item v="Egitto"/>
      <list-item v="Ellesmere"/>
<!--      <list-item v="El Salvador"/> -->
      <list-item v="Eritrea"/>
      <list-item v="Estonia"/>
      <list-item v="Etiopia"/>
      <list-item v="Fær Øer"/>
      <list-item v="Filippine"/>
      <list-item v="Finlandia"/>
      <list-item v="Francia"/>
      <list-item v="Gabon"/>
      <list-item v="Gambia"/>
      <list-item v="Georgia"/>
      <list-item v="Germania"/>
      <list-item v="Ghana"/>
      <list-item v="Nuova Guinea"/>
      <list-item v="Giamaica"/>
<!--      <list-item v="Giappone"/> -->
      <list-item v="Giava"/>
      <list-item v="Gibuti"/>
      <list-item v="Giordania"/>
      <list-item v="Grenada"/>
      <list-item v="Grecia"/>
      <list-item v="Groenlandia"/>
      <list-item v="Guadalupa"/>
      <list-item v="Guyana francese"/>
      <list-item v="Guam"/>
      <list-item v="Guatemala"/>
      <list-item v="Guinea"/>
      <list-item v="Guinea Bissau"/>
      <list-item v="Guinea Equatoriale"/>
      <list-item v="Guyana"/>
      <list-item v="Haiti"/>
      <list-item v="Honduras"/>
      <list-item v="Indonesia"/>
      <list-item v="Iran"/>
      <list-item v="Iraq"/>
      <list-item v="Irlanda"/>
      <list-item v="Irlanda del Nord"/>
      <list-item v="Islanda"/>
      <list-item v="Spagna"/>
      <list-item v="Israele"/>
      <list-item v="Svezia"/>
      <list-item v="Svizzera"/>
      <list-item v="Italia"/>
<!--      <list-item v="Yemen"/> -->
      <list-item v="Kazakistan"/>
      <list-item v="Kenya"/>
      <list-item v="Kirghizistan"/>
      <list-item v="Kiribati"/>
      <list-item v="Kuwait"/>
      <list-item v="Laos"/>
      <list-item v="Lesotho"/>
      <list-item v="Lettonia"/>
<!--      <list-item v="Libano"/> -->
      <list-item v="Liberia"/>
      <list-item v="Libia"/>
      <list-item v="Lituania"/>
      <list-item v="Lussemburgo"/>
      <list-item v="Luzon"/>
      <list-item v="Macedonia"/>
      <list-item v="Macedonia del Nord"/>
      <list-item v="Madagascar"/>
      <list-item v="Malesia"/>
      <list-item v="Malawi"/>
      <list-item v="Mali"/>
      <list-item v="Malpelo"/>
      <list-item v="Malta"/>
      <list-item v="Marocco"/>
      <list-item v="Mauritania"/>
      <list-item v="Mauritius"/>
      <list-item v="Melville"/>
      <list-item v="Messico"/>
      <list-item v="Mindanao"/>
      <list-item v="Mongolia"/>
      <list-item v="Mozambico"/>
      <list-item v="Myanmar"/>
      <list-item v="Birmania"/>
      <list-item v="Cambogia"/>
      <list-item v="Namibia"/>
      <list-item v="Nauru"/>
<!--      <list-item v="Nepal"/> -->
      <list-item v="Nicaragua"/>
      <list-item v="Niger"/>
      <list-item v="Nigeria"/>
      <list-item v="Norfolk"/>
      <list-item v="Norvegia"/>
      <list-item v="Olanda"/>
      <list-item v="Oman"/>
      <list-item v="Pakistan"/>
      <list-item v="Palestina"/>
      <list-item v="Panama"/>
      <list-item v="Papua"/>
      <list-item v="Paraguay"/>
<!--      <list-item v="Perù"/> -->
      <list-item v="Polonia"/>
      <list-item v="Portogallo"/>
      <list-item v="Puerto Rico"/>
      <list-item v="Qatar"/>
      <list-item v="Romania"/>
      <list-item v="Ruanda"/>
      <list-item v="Russia"/>
      <list-item v="Siberia"/>
<!--      <list-item v="Sahara Occidentale"/> -->
      <list-item v="Santa Lucia"/>
      <list-item v="São Tomé e Príncipe"/>
      <list-item v="Saint Vincent e Grenadine"/>
<!--      <list-item v="Senegal"/> -->
      <list-item v="Serbia"/>
      <list-item v="Nuova Siberia"/>
      <list-item v="Sierra Leone"/>
      <list-item v="Singapore"/>
      <list-item v="Siria"/>
      <list-item v="Somalia"/>
      <list-item v="Somerset"/>
      <list-item v="Southampton"/>
      <list-item v="Sri Lanka"/>
      <list-item v="Saint-Pierre e Miquelon"/>
      <list-item v="Sudan"/>
      <list-item v="Sumatra"/>
      <list-item v="Suriname"/>
      <list-item v="Swaziland"/>
      <list-item v="Tagikistan"/>
      <list-item v="Tailandia"/>
      <list-item v="Taiwan"/>
      <list-item v="Tanzania"/>
      <list-item v="Tasmania"/>
      <list-item v="Terranova"/>
      <list-item v="Timor"/>
      <list-item v="Togo "/>
      <list-item v="Trinidad e Tobago"/>
      <list-item v="Tunisia"/>
      <list-item v="Turchia"/>
      <list-item v="Turkmenistan"/>
      <list-item v="Tuvalu"/>
      <list-item v="Cile"/>
<!--      <list-item v="Cina"/> -->
      <list-item v="Cipro"/>
      <list-item v="Ucraina"/>
      <list-item v="E.a.u."/>
      <list-item v="Uganda"/>
      <list-item v="Ungheria"/>
<!--      <list-item v="Uruguay"/> -->
      <list-item v="Uzbekistan"/>
      <list-item v="Vanuatu"/>
      <list-item v="Venezuela"/>
      <list-item v="Vietnam"/>
      <list-item v="Zambia"/>
      <list-item v="Nuova Zelanda"/>
      <list-item v="Zimbawe"/>
<!--      <list-item v="Piemonte"/> -->
      <list-item v="Liguria"/>
      <list-item v="Lombardia"/>
      <list-item v="Trentino-Alto Adige"/>
      <list-item v="Trentino"/>
<!--      <list-item v="Veneto"/> -->
      <list-item v="Friuli"/>
      <list-item v="Friuli-Venezia Giulia"/>
      <list-item v="Emilia-Romagna"/>
      <list-item v="Emilia"/>
      <list-item v="Romagna"/>
<!--      <list-item v="Toscana"/> -->
      <list-item v="Umbria"/>
<!--      <list-item v="Lazio"/> -->
      <list-item v="Abruzzo"/>
      <list-item v="Molise"/>
      <list-item v="Campania"/>
      <list-item v="Basilicata"/>
      <list-item v="Puglia"/>
      <list-item v="Calabria"/>
      <list-item v="Sicilia"/>
      <list-item v="Sardegna"/>
      <list-item v="Catalogna"/>
<!--      <list-item v="Catalogna del Nord"/> -->
      <list-item v="Aragona"/>
      <list-item v="Castiglia"/>
      <list-item v="Andalusia"/>
      <list-item v="Galizia"/>
      <list-item v="Biscaglia"/>
      <list-item v="Bretagna"/>
      <list-item v="Occitania"/>
      <list-item v="Linguadoca"/>
      <list-item v="Provenza"/>
      <list-item v="Aquitania"/>
      <list-item v="Guascogna"/>
      <list-item v="Normandia"/>
      <list-item v="Corsica"/>
<!--      <list-item v="Rossiglione"/> -->
      <list-item v="Inghilterra"/>
      <list-item v="Scozia"/>
      <list-item v="Galles"/>
      <list-item v="Devon"/>
      <list-item v="Cornovaglia"/>
      <list-item v="Fiandra"/>
      <list-item v="Fiandre"/>
      <list-item v="Frisia"/>
      <list-item v="Drenthe"/>
      <list-item v="Zelanda"/>
      <list-item v="Baden-Württemberg"/>
      <list-item v="Baviera"/>
      <list-item v="Brandeburgo"/>
      <list-item v="Renania"/>
<!--      <list-item v="Palatinato"/> -->
      <list-item v="Renania-Palatinato"/>
      <list-item v="Vestfalia"/>
      <list-item v="Renania Settentrionale-Vestfalia"/>
      <list-item v="Sassonia"/>
      <list-item v="Schleswig-Holstein"/>
      <list-item v="Boemia"/>
      <list-item v="Moravia"/>
      <list-item v="Slesia"/>
      <list-item v="Crimea"/>
<!--      <list-item v="Tibet"/> -->
      <list-item v="Alabama"/>
      <list-item v="Alaska"/>
      <list-item v="Arizona"/>
      <list-item v="California"/>
      <list-item v="Carolina del Nord"/>
      <list-item v="Carolina del Sud"/>
      <list-item v="Connecticut"/>
      <list-item v="Dakota del Nord"/>
      <list-item v="Dakota del Sud"/>
      <list-item v="Idaho"/>
      <list-item v="Illinois"/>
      <list-item v="Indiana"/>
      <list-item v="Kansas"/>
      <list-item v="Kentucky"/>
      <list-item v="Louisiana"/>
      <list-item v="Massachusetts"/>
      <list-item v="Michigan"/>
      <list-item v="Minnesota"/>
      <list-item v="Missouri"/>
      <list-item v="Montana"/>
      <list-item v="Nevada"/>
      <list-item v="New England"/>
      <list-item v="New Hampshire"/>
      <list-item v="New Jersey"/>
      <list-item v="Oklahoma"/>
      <list-item v="Ohio"/>
      <list-item v="Texas"/>
      <list-item v="Utah"/>
      <list-item v="Wyoming"/>
      <list-item v="Wisconsin"/>
      <list-item v="Alberta"/>
      <list-item v="Labrador"/>
      <list-item v="Manitoba"/>
      <list-item v="Ontario"/>
<!--      <list-item v="Quebec"/> -->
      <list-item v="Saskatchewan"/>
<!--      <list-item v="Terranova"/> -->
      <list-item v="Rio Grande do Sul"/>
      <list-item v="Polinesia"/>
      <list-item v="Melanesia"/>
      <list-item v="Micronesia"/>
      <list-item v="Prussia"/>
      <list-item v="Persia"/>
      <list-item v="Mesopotamia"/>
      <list-item v="Babilonia"/>
      <list-item v="Caldea"/>
      <list-item v="Giudea"/>
      <list-item v="Cecoslovacchia"/>
      <list-item v="Jugoslavia"/>
    </def-list>
  </section-def-lists>

  <section-def-macros>
    <def-macro n="firstWord" npar="1">
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="sl" part="a_np_acr"/>
              <lit v=""/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal> 
                  <var n="EOS"/>
                  <lit v="true"/>
                </equal> 
              </test>
              <modify-case>
                <clip pos="1" side="tl" part="lem"/>
                <lit v="aa"/>
              </modify-case>
              <let>
                <var n="caseFirstWord"/>
                <lit v="Aa"/>
              </let>
            </when>
            <otherwise> 
              <let>
                <var n="caseFirstWord"/>
                <lit v="aa"/>
              </let>
            </otherwise>
          </choose>
        </when>
        <otherwise>
          <let>
            <var n="caseFirstWord"/>
            <lit v="aa"/>
          </let>
        </otherwise>
      </choose>
      <let>
        <var n="EOS"/>
        <lit v="false"/>
      </let>
    </def-macro>


    <def-macro n="f_bcond" npar="2"><!--Per mirar si el blanc cont?o no format. Cal posar aquesta funci?en les regles en qu?desaparegui alguna paraula, per tal de decidir si el blanc de la paraula eliminada s'ha d'eliminar o conservar. Si cont?format cal conservar-la, si no en cont?cal eliminar-la perqu?no apareguin dos espais seguits. -->
      <choose>
        <when>
          <test>
            <not>
              <equal>
                <b pos="1"/>
                <lit v=" "/>
              </equal>
            </not>
          </test>
          <out>
            <b pos="1"/>
          </out>
        </when>                 
      </choose>
    </def-macro>


    <def-macro n="f_salvar_gen_num" npar="0"> <!-- Per conservar les var genero i numero per restaurar-les després (per no expandir a l'esquerra aquests valors) -->
      <let><var n="genero_aux"/><var n="genero"/></let>
      <let><var n="numero_aux"/><var n="numero"/></let>
    </def-macro>


    <def-macro n="f_restaurar_gen_num" npar="0"> <!-- Per restaurar les var genero i numero i no expandir-ne a l'esquerra els valors -->
      <let><var n="genero"/><var n="genero_aux"/></let>
      <let><var n="numero"/><var n="numero_aux"/></let>
    </def-macro>


    <def-macro n="f_pretind" npar="2"><!--Para traducir el pretérito indefinido por la forma perifrástica (dije - vaig dir) y enviar el verbo. Debe ponerse en todas las reglas en las que aparezca un verbo vblex, vbmod o vbser --> <!-- El segundo parámetro es sólo para coger la mayúscula/minúscula (habitualmente es el mismo parámetro que el primero -->
      <let>
        <var n="verbfinal"/>
        <lit v=""/>
      </let>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="sl" part="temps"/>
              <lit-tag v="ifi"/>
            </equal>
          </test>
          <let>
            <var n="verbfinal"/>
              <concat>
              <get-case-from pos="2">
                  <lit v="anar"/>
              </get-case-from>
              <lit-tag v="vaux"/>
              <clip pos="1" side="sl" part="pers"/>
              <clip pos="1" side="sl" part="nbr"/>
              <lit v="$ ^"/>
            </concat>
          </let> 
          <choose>
            <when>
              <test>
                <equal>
                  <case-of pos="2" side="sl" part="lemh"/>
                  <lit v="Aa"/>
                </equal>
              </test>
              <modify-case>
                <clip pos="2" side="tl" part="lemh"/> 
                <lit v="aa"/>
              </modify-case>
            </when>
          </choose>
          <modify-case>
            <clip pos="1" side="tl" part="lemh"/>
            <lit v="aa"/>
          </modify-case>
          <let>
            <var n="verbfinal"/>
            <concat>
              <var n="verbfinal"/>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <lit-tag v="inf"/>
              <clip pos="1" side="tl" part="lemq"/>
            </concat>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="verbfinal"/>
            <concat>
              <var n="verbfinal"/>
                <get-case-from pos="2">
              <clip pos="1" side="tl" part="lemh"/>
                </get-case-from>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="pers"/>
              <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </concat>
          </let>
        </otherwise>
      </choose>
    </def-macro>


    <def-macro n="f_concord1" npar="1">
      <choose>
        <!--To determine value of variables of gender and
            number and propagate to other rules.  Variables are
            not used again in this rule -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="mf"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="mf"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <!-- If word has GD or ND, we try to assign the
                 gender or number of the previous rule. If there is no
                 value for the gender or number variable from previous
                 rules, gender will be masculine and number singular.-->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="genero"/>
                  <lit-tag v="f"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="f"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="m"/>
              </let>
              <let>
                <var n="genero"/>
                <lit-tag v="m"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <choose>
            <when>
              <test>
                <equal>
                  <var n="numero"/>
                  <lit-tag v="pl"/>
                </equal>
              </test>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="pl"/>
              </let>
            </when>
            <otherwise>
              <let>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sg"/>
              </let>
              <let>
                <var n="numero"/>
                <lit-tag v="sg"/>
              </let>
            </otherwise>
          </choose>
        </when>
      </choose>
    </def-macro>
    

    <def-macro n="f_concord2" npar="2"> <!-- p1: nom, p2: num (si n'hi ha un) -->

      <!-- pedaç per a coses com "200.000 unità" i "tre unità" -->
      <!--
        ^200.000<num>/200.000<num>$ ^unità<n><f><sp>/unitat<n><f><ND>$
        ^tre<num><mf><sp>/tres<num><mf><sp>$ ^unità<n><f><sp>/unitat<n><f><ND>$^
      -->
      <choose>
        <when>
          <test>
            <and>
              <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
              <equal><clip pos="2" side="tl" part="a_num"/><lit-tag v="num"/></equal>
	      <or>
                <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sp"/></equal>
                <equal><clip pos="2" side="tl" part="nbr"/><lit v=""/></equal>
              </or>
            </and>
          </test>
          <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="pl"/></let>
          <let><var n="numero"/><lit-tag v="pl"/></let>
        </when>
      </choose>

      <choose>
        <when>
          <test>
            <!-- do the main and second parameter gender agree?-->
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <!-- do the main and second parameter number agree?-->
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
          <!-- there is gender and number agreement-->
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
          <!-- there isn't gender and number agreement-->
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <!-- Propagate the main parameter gender if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <!-- Propagate the main parameter number if it has been modified during the translation  -->
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <!-- Which is the rule general gender? -->
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <or>
              <and>
                <equal>
                  <clip pos="2" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </and>
              <and>
                <equal>
                  <clip pos="2" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </and>
              <and>
                <equal>
                  <clip pos="2" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </and>
            </or>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="GD"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </otherwise>

      </choose>
      <choose>
        <when>
          <test>
            <!-- Which is the rule general number? -->
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="ND"/>
          </let>
        </when>
        <!--       <otherwise>
             <let>
             <var n="genero"/>
             <lit-tag v="m"/>
             </let>
             </otherwise>-->
      </choose>
      <!-- Determine gender and number value if they are undetermined -->
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_concord3" npar="3"> <!-- p1: nom, p2: num (si n'hi ha un) -->

      <!-- pedaç per a coses com "200.000 unità" i "tre unità" -->
      <!--
        ^200.000<num>/200.000<num>$ ^unità<n><f><sp>/unitat<n><f><ND>$
        ^tre<num><mf><sp>/tres<num><mf><sp>$ ^unità<n><f><sp>/unitat<n><f><ND>$^
      -->
      <choose>
        <when>
          <test>
            <and>
              <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
              <equal><clip pos="2" side="tl" part="a_num"/><lit-tag v="num"/></equal>
	      <or>
                <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="sp"/></equal>
                <equal><clip pos="2" side="tl" part="nbr"/><lit v=""/></equal>
              </or>
            </and>
          </test>
          <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="pl"/></let>
          <let><var n="numero"/><lit-tag v="pl"/></let>
        </when>
      </choose>

      <choose>
        <!-- Look whether in source language there is concordance between first and second element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <!-- Look whether in source language there is concordance between second and third element -->
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <!-- Propagate the main parameter gender if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <!-- Propagate the main parameter number if it has been modified during the translation -->
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <!-- Determine the rule general gender. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="3" side="sl" part="gen"/>
          </let>
        </when>
        
        <!--                        <when>
            <test>
            <or>
            <and>
            <equal>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="GD"/>
            </equal>
            <equal>
            <clip pos="2" side="tl" part="gen"/>
            <lit-tag v="GD"/>
            </equal>
            <equal>
            <clip pos="3" side="tl" part="gen"/>
            <lit-tag v="GD"/>
            </equal>
            </and>
            </test>
            <let>
            <var n="genero"/>
            <lit-tag v="GD"/>
            </let>
            </when>-->
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="GD"/>
          </let>
        </otherwise>
      </choose>

      <choose>
        <!-- Determine the rule general number. Priority order: main, second and third element -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="3" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
              <equal>
                <clip pos="3" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="ND"/>
          </let>
        </when>
        
      </choose>
      <choose>
        <!-- Assign values to GD and ND -->
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>
    
    <def-macro n="f_concord4" npar="4">
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concPrimero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concPrimero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concSegundo"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concSegundo"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </or>
              <or>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </or>
            </and>
          </test>
          <let>
            <var n="concTercero"/>
            <lit v="true"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="concTercero"/>
            <lit v="false"/>
          </let>
        </otherwise>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="sl" part="gen"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="gen"/>
                  <lit-tag v="GD"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="gen"/>
                      <lit-tag v="mf"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="gen"/>
                        <lit-tag v="mf"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="gen"/>
                          <lit-tag v="GD"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="gen"/>
                <clip pos="1" side="tl" part="gen"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <and>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="sl" part="nbr"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
              <not>
                <equal>
                  <clip pos="1" side="tl" part="nbr"/>
                  <lit-tag v="ND"/>
                </equal>
              </not>
            </and>
          </test>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="2" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="2" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="2" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concPrimero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="2" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="3" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="3" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="3" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concSegundo"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="3" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
          <choose>
            <when>
              <test>
                <and>
                  <not>
                    <equal>
                      <clip pos="4" side="tl" part="nbr"/>
                      <lit-tag v="sp"/>
                    </equal>
                  </not>
                  <not>
                    <and>
                      <equal>
                        <clip pos="4" side="sl" part="nbr"/>
                        <lit-tag v="sp"/>
                      </equal>
                      <not>
                        <equal>
                          <clip pos="4" side="tl" part="nbr"/>
                          <lit-tag v="ND"/>
                        </equal>
                      </not>
                    </and>
                  </not>
                  <equal>
                    <var n="concTercero"/>
                    <lit v="true"/>
                  </equal>
                </and>
              </test>
              <let>
                <clip pos="4" side="tl" part="nbr"/>
                <clip pos="1" side="tl" part="nbr"/>
              </let>
            </when>
          </choose>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="m"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="f"/>
            </equal>
          </test>
          <let>
            <var n="genero"/>
            <lit-tag v="f"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="1" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="2" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="3" side="sl" part="gen"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="4" side="tl" part="gen"/>
                <lit-tag v="mf"/>
              </equal>
              <not>
                <equal>
                  <clip pos="4" side="sl" part="gen"/>
                  <lit-tag v="mf"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="genero"/>
            <clip pos="4" side="sl" part="gen"/>
          </let>
        </when>
        <otherwise>
          <let>
            <var n="genero"/>
            <lit-tag v="GD"/>
          </let>
        </otherwise>
        <!--                                <when>
            <test>
            <and>
            <equal>
            <clip pos="1" side="tl" part="gen"/>
            <lit-tag v="GD"/>
            </equal>
            <equal>
            <clip pos="2" side="tl" part="gen"/>
            <lit-tag v="GD"/>
            </equal>
            <equal>
            <clip pos="3" side="tl" part="gen"/>
            <lit-tag v="GD"/>
            </equal>
            <equal>
            <clip pos="4" side="tl" part="gen"/>
            <lit-tag v="GD"/>
            </equal>
            </and>
            </test>
            <let>
            <var n="genero"/>
            <lit-tag v="GD"/>
            </let>
            </when>-->
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="sg"/>
          </let>
        </when>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="pl"/>
            </equal>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="pl"/>
          </let>
        </when>
        

        <!--<when>
            <test>
            <and>
            <equal>
            <clip pos="1" side="tl" part="nbr"/>
            <lit-tag v="ND"/>
            </equal>
            <equal>
            <clip pos="2" side="tl" part="nbr"/>
            <lit-tag v="ND"/>
            </equal>
            <equal>
            <clip pos="3" side="tl" part="nbr"/>
            <lit-tag v="ND"/>
            </equal>
            <equal>
            <clip pos="4" side="tl" part="nbr"/>
            <lit-tag v="ND"/>
            </equal>
            </and>
            </test>
            <let>
            <var n="numero"/>
            <lit-tag v="ND"/>
            </let>
            </when>-->
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="1" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="1" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="2" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="2" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="3" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="3" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="3" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="4" side="tl" part="nbr"/>
                <lit-tag v="sp"/>
              </equal>
              <not>
                <equal>
                  <clip pos="4" side="sl" part="nbr"/>
                  <lit-tag v="sp"/>
                </equal>
              </not>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <clip pos="4" side="sl" part="nbr"/>
          </let>
        </when>
        <when>
          <test>
            <and>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
              <equal>
                <clip pos="2" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
              <equal>
                <clip pos="3" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
              <equal>
                <clip pos="4" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
            </and>
          </test>
          <let>
            <var n="numero"/>
            <lit-tag v="ND"/>
          </let>
        </when>
        
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="gen"/>
              <lit-tag v="GD"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="gen"/>
            <var n="genero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="1" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="2" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="2" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="3" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="3" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal>
              <clip pos="4" side="tl" part="nbr"/>
              <lit-tag v="ND"/>
            </equal>
          </test>
          <let>
            <clip pos="4" side="tl" part="nbr"/>
            <var n="numero"/>
          </let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_vauxiliar" npar="2">
      <choose>
        <when>
          <test>
            <in caseless="yes"> <!-- comprovem si el vblex s a la llista-->
              <clip pos="2" side="sl" part="lem"/>
              <list n="vbambser"/>
            </in>
          </test>
          <let><clip pos="1" side="tl" part="lem"/><lit v="haver"/></let>
          <let><clip pos="1" side="tl" part="a_verb"/><lit-tag v="vaux"/></let>
          <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
          <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_vauxiliar_pron" npar="3">
      <choose>
        <when>
          <test> <!-- comprovem si és un pronom reflexiu (formalment: la persona i el nombre corresponen amb el verb) -->
            <and>
	      <equal><clip pos="1" side="tl" part="pers"/><clip pos="2" side="tl" part="pers"/></equal>
              <or>
                <and>
	          <equal><clip pos="1" side="tl" part="pers"/><lit-tag v="p3"/></equal>
	          <equal><clip pos="1" side="tl" part="tipus_prn"/><lit-tag v="prn.pro.ref"/></equal>
                </and>
                <and>
	        <equal><clip pos="1" side="tl" part="tipus_prn"/><lit-tag v="prn.pro"/></equal>
	        <equal><clip pos="1" side="tl" part="nbr"/><clip pos="2" side="tl" part="nbr"/></equal>
                </and>
              </or>
            </and>
          </test>
          <let><clip pos="2" side="tl" part="lem"/><lit v="haver"/></let>
          <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vaux"/></let>
          <let><clip pos="3" side="tl" part="gen"/><lit-tag v="m"/></let>
          <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></let>
        </when>
        <when>
          <test>
            <in caseless="yes"> <!-- comprovem si el vblex s a la llista-->
              <clip pos="3" side="sl" part="lem"/>
              <list n="vbambser"/>
            </in>
          </test>
          <let><clip pos="2" side="tl" part="lem"/><lit v="haver"/></let>
          <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vaux"/></let>
          <let><clip pos="3" side="tl" part="gen"/><lit-tag v="m"/></let>
          <let><clip pos="3" side="tl" part="nbr"/><lit-tag v="sg"/></let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_set_pron" npar="2"> <!-- posa a la variable 'pronom' el pronom reflexiu que calgui si el verb és reflexiu. El segon paramàtre és la repetició del primer, si és una forma conjugada (personal) del verb, altrament és l'auxiliar-->
      <let>
	<var n="pronom"/>
	<lit v=""/>
      </let>
<let><var n="debug1"/><lit v="0"/></let>
      <choose>
	<when>
	  <test>
	    <equal><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex.pron"/></equal>
	  </test>
	  <let>
            <var n="pronom"/>
            <get-case-from pos="1">
              <lit v="pronom"/>
            </get-case-from>
	  </let>
	  <append n="pronom">
	    <lit-tag v="SN.prn.pro.ref.p3.mf.sp"/>
	    <lit v="{^"/>
          </append>
          <choose>
<!-- ^pronom<SN><prn><tn><p3><m><sg>{^ell<prn><tn><p3><m><sg>$}$ ^es<prn><pro><ref><p3><mf><sp>$ -->
	    <when>
	      <test>
	        <equal><clip pos="2" side="tl" part="pers"/><lit-tag v="p3"/></equal>
	      </test>
	      <append n="pronom">
                <get-case-from pos="1">
                  <lit v="es"/>
                </get-case-from>
              </append>
	      <append n="pronom">
	        <lit-tag v="prn.pro.ref.p3.mf.sp"/>
	        <lit v="$^}"/>
	      </append>	
<let><var n="debug1"/><lit v="1"/></let>
	    </when>
	    <otherwise>
	      <append n="pronom">
                <get-case-from pos="1">
                  <lit v="prpers"/>
                </get-case-from>
              </append>
	      <append n="pronom">
	        <lit-tag v="prn.pro"/>
                <clip pos="2" side="tl" part="pers"/>
	        <lit-tag v="mf"/>
	        <clip pos="1" side="tl" part="nbr"/>
	        <lit v="$^}^"/>
	      </append>	
<let><var n="debug1"/><lit v="2"/></let>
	    </otherwise>
          </choose>
          <!-- ara arreglem la majúscula del verb, si cal -->
          <choose>
            <when>
              <test>
                <equal>
                   <case-of pos="1" side="sl" part="lem"/>
                   <lit v="Aa"/>
                 </equal>
              </test>
              <modify-case>
                <clip pos="1" side="tl" part="lemh"/>
                <lit v="aa"/>
              </modify-case>
            </when>
          </choose>
	  <let><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex"/></let>
	</when>
	<otherwise>
<let><var n="debug1"/><lit v="3"/></let>
	</otherwise>
      </choose>
    </def-macro>

    <def-macro n="f_set_pron_enc" npar="1"> <!-- posa a la variable 'pronom' el pronom reflexiu enclític 'es´ si el verb és reflexiu -->
      <let>
	<var n="pronom"/>
	<lit v=""/>
      </let>
      <choose>
	<when>
	  <test>
	    <equal><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex.pron"/></equal>
	  </test>
	  <let><var n="pronom"/><lit v="es"/></let>
	  <append n="pronom">
	    <lit-tag v="prn.enc.ref.p3.mf.sp"/>
	  </append>	
	  <let><clip pos="1" side="tl" part="a_verb_pron"/><lit-tag v="vblex"/></let>
	</when>
      </choose>
    </def-macro>

    <def-macro n="print_pron" npar="0"> <!-- escriu la variable 'pronom' -->
        <choose>
	  <when>
	    <test>
	      <not><equal><var n="pronom"/><lit v=""/></equal></not>
	    </test>
            <out>
              <lu>
	        <var n="pronom"/>
              </lu>
              <b/>
            </out>
	  </when>
        </choose>
<!--
            <out>
              <lu>
	        <var n="debug1"/>
              </lu>
            </out>
-->
    </def-macro>

    <def-macro n="f_giorno" npar="1"> <!-- per a convertir els 1º en 1 -->
      <let>
        <var n="numerodia"/>
        <lit v=""/>
      </let>
      <choose>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="lem"/><lit v="1º"/></equal>
          </test>
          <let><var n="numerodia"/>
              <concat>
              <lit v="1"/>
              <lit-tag v="num"/>
              <lit v="$^"/>
            </concat>
          </let> 
        </when>
        <otherwise>
          <let><var n="numerodia"/>
              <concat>
              <clip pos="1" side="tl" part="lem"/>
              <clip pos="1" side="tl" part="tags"/>
            </concat>
          </let> 
        </otherwise>
      </choose>
    </def-macro>

    <def-macro n="f_chunk_tags_gen" npar="1">
      <choose>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="m"/></equal>
          </test>
          <let><var n="genero_sl"/><lit-tag v="sl_m"/></let>
        </when>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="f"/></equal>
          </test>
          <let><var n="genero_sl"/><lit-tag v="sl_f"/></let>
        </when>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="mf"/></equal>
          </test>
          <let><var n="genero_sl"/><lit-tag v="sl_mf"/></let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_chunk_tags_nbr" npar="1">
      <choose>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sg"/></equal>
          </test>
          <let><var n="numero_sl"/><lit-tag v="sl_sg"/></let>
        </when>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="pl"/></equal>
          </test>
          <let><var n="numero_sl"/><lit-tag v="sl_pl"/></let>
        </when>
        <when>
          <test>
            <equal><clip pos="1" side="sl" part="nbr"/><lit-tag v="sp"/></equal>
          </test>
          <let><var n="numero_sl"/><lit-tag v="sl_sp"/></let>
        </when>
      </choose>
    </def-macro>

    <def-macro n="f_chunk_tags" npar="1">
      <call-macro n="f_chunk_tags_gen"><with-param pos="1"/></call-macro>
      <call-macro n="f_chunk_tags_nbr"><with-param pos="1"/></call-macro>
    </def-macro>

    <def-macro n="f_chunk_tags2" npar="2">
      <let><var n="genero_sl"/><lit-tag v=""/></let>
      <call-macro n="f_chunk_tags_gen"><with-param pos="1"/></call-macro>
      <let><var n="numero_sl"/><lit-tag v=""/></let>
      <call-macro n="f_chunk_tags_nbr"><with-param pos="1"/></call-macro>
      <!-- si el primer paràmetre no assigna gènere o nombre, provem amb el següent -->
      <choose>
        <when>
          <test>
            <equal><var n="genero_sl"/><lit-tag v=""/></equal>
          </test>
          <call-macro n="f_chunk_tags_gen">
            <with-param pos="2"/>
          </call-macro>
        </when>
      </choose>
      <choose>
        <when>
          <test>
            <equal><var n="numero_sl"/><lit-tag v=""/></equal>
          </test>
          <call-macro n="f_chunk_tags_nbr">
            <with-param pos="2"/>
          </call-macro>
        </when>
      </choose>
    </def-macro>
  </section-def-macros>

  <section-rules>

    <rule comment="PRN"><!--Special case, macro f_concord1 is not applicable because gender and number can not be taken from previous rules -->
      <pattern>
        <pattern-item n="prn"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="GD"/>
              </equal>
            </test>
            <let>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
            </test>
            <let>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </let>
          </when>
        </choose>
        <out>
          <chunk name="pronom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tipus_prn"/>
              <clip pos="1" side="tl" part="pers"/>
              <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="genero"/>
          <clip pos="1" side="tl" part="gen"/>
        </let>
        <let>
          <var n="numero"/>
          <clip pos="1" side="tl" part="nbr"/>
        </let>
      </action>
    </rule>


    <rule comment="noi tutti > tots nosaltres">
      <pattern>
        <pattern-item n="prnpers_subj"/>
        <pattern-item n="tutto_prn"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="gen"/>
                <lit-tag v="GD"/>
              </equal>
            </test>
            <let>
              <clip pos="1" side="tl" part="gen"/>
              <lit-tag v="m"/>
            </let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal>
                <clip pos="1" side="tl" part="nbr"/>
                <lit-tag v="ND"/>
              </equal>
            </test>
            <let>
              <clip pos="1" side="tl" part="nbr"/>
              <lit-tag v="sg"/>
            </let>
          </when>
        </choose>
        <out>
          <chunk name="pronom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lemh"/>
              </get-case-from>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <get-case-from pos="2">
                <clip pos="1" side="tl" part="lemh"/>
              </get-case-from>
              <clip pos="1" side="tl" part="tipus_prn"/>
              <clip pos="1" side="tl" part="pers"/>
              <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="genero"/>
          <clip pos="1" side="tl" part="gen"/>
        </let>
        <let>
          <var n="numero"/>
          <clip pos="1" side="tl" part="nbr"/>
        </let>
      </action>
    </rule>


    <rule comment="PRNPRO PRNPRO">
      <pattern>
        <pattern-item n="prnpro"/>
        <pattern-item n="prnpro"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal><clip pos="1" side="tl" part="gen"/><lit-tag v="GD"/></equal>
            </test>
            <let><clip pos="1" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal><clip pos="1" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
            </test>
            <let><clip pos="1" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="tl" part="gen"/><lit-tag v="GD"/></equal>
            </test>
            <let><clip pos="2" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal><clip pos="2" side="tl" part="nbr"/><lit-tag v="ND"/></equal>
            </test>
            <let><clip pos="2" side="tl" part="nbr"/><lit-tag v="sg"/></let>
          </when>
        </choose>
        <choose>
          <when>
            <test>
              <equal caseless="yes"><clip pos="2" side="tl" part="lem"/><lit v="es"/></equal>
            </test>
            <out>
              <chunk name="pronom" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
                  <tag><clip pos="2" side="tl" part="pers"/></tag>
                  <tag><clip pos="2" side="tl" part="gen"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <get-case-from pos="1">
                    <clip pos="2" side="tl" part="lemh"/>
                  </get-case-from>
                  <clip pos="2" side="tl" part="tipus_prn"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
              <b pos="1"/>
              <chunk name="pronom" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="gen"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <get-case-from pos="2">
                    <clip pos="1" side="tl" part="lemh"/>
                  </get-case-from>
                  <clip pos="1" side="tl" part="tipus_prn"/>
                  <clip pos="1" side="tl" part="pers"/>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="pronom" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><clip pos="1" side="tl" part="tipus_prn"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="gen"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="tipus_prn"/>
                  <clip pos="1" side="tl" part="pers"/>
                  <clip pos="1" side="tl" part="gen"/>
                  <clip pos="1" side="tl" part="nbr"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
              <b pos="1"/>
              <chunk name="pronom" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
                  <tag><clip pos="2" side="tl" part="pers"/></tag>
                  <tag><clip pos="2" side="tl" part="gen"/></tag>
                  <tag><clip pos="2" side="tl" part="nbr"/></tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/>
                  <clip pos="2" side="tl" part="tipus_prn"/>
                  <clip pos="2" side="tl" part="pers"/>
                  <clip pos="2" side="tl" part="gen"/>
                  <clip pos="2" side="tl" part="nbr"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let><var n="genero"/><clip pos="1" side="tl" part="gen"/></let>
        <let><var n="numero"/><clip pos="1" side="tl" part="nbr"/></let>
      </action>
    </rule>


    <rule comment="REGLA: NP">
      <pattern>
        <pattern-item n="np"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="np" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/> 
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: NOM">
      <pattern>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/> 
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/> 
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: rel">
      <pattern>
        <pattern-item n="rel"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="rel" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="rel"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: cnjadv">
      <pattern>
        <pattern-item n="cnjadv"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="cnjadv" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="cnjadv"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: cnjsub">
      <pattern>
        <pattern-item n="cnjsub"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="cnjsub" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="cnjsub"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: cnjcoo">
      <pattern>
        <pattern-item n="cnjcoo"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="cnjcoo" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="cnjcoo"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: adv_preadv">
      <pattern>
        <pattern-item n="adv_preadv"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="adv" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SAdv"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: PREP">
      <pattern>
        <pattern-item n="pr"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="pr"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
        <!-- després de preposició no té sentit "coordinar" genère i nombre: "endeveninem" que coses com "abilità" seran en singular -->
        <let><var n="genero"/><lit-tag v="m"/></let>
        <let><var n="numero"/><lit-tag v="sg"/></let>
      </action>
    </rule>

    <rule comment="REGLA: QUELLO PREP (quello di > el de)">
      <pattern>
        <pattern-item n="quello"/>
        <pattern-item n="pr"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="nt"/></equal>
            </test>
            <let><var n="genero"/><lit-tag v="m"/></let>
            <let><clip pos="1" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <out>
          <chunk name="pronom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><lit-tag v="prn.tn"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="sl" part="nbr"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <lit v="el"/>
              </get-case-from>
              <lit-tag v="det.def"/>
              <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="sl" part="nbr"/>
            </lu>
          </chunk>
          <b pos="1"/>
        </out>
        <call-macro n="firstWord">
          <with-param pos="2"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="2" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="pr"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: QUELLO REL (quel che > el que)">
      <pattern>
        <pattern-item n="quello"/>
        <pattern-item n="rel"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <equal><clip pos="1" side="sl" part="gen"/><lit-tag v="nt"/></equal>
            </test>
            <let><var n="genero"/><lit-tag v="m"/></let>
            <let><clip pos="1" side="tl" part="gen"/><lit-tag v="m"/></let>
          </when>
        </choose>
        <out>
          <chunk name="pronom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><lit-tag v="prn.tn"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="sl" part="nbr"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <lit v="el"/>
              </get-case-from>
              <lit-tag v="det.def"/>
              <clip pos="1" side="tl" part="gen"/>
              <clip pos="1" side="sl" part="nbr"/>
            </lu>
          </chunk>
          <b pos="1"/>
        </out>
        <call-macro n="firstWord">
          <with-param pos="2"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="2" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="rel"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET REL">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="rel"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="rel" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="rel"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/> 
            </lu> 
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="regla: num_romano secolo: I secolo > segle I">
      <pattern>
        <pattern-item n="num_romano"/>
        <pattern-item n="secolo_sg"/>
      </pattern>
      <action>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <call-macro n="f_concord1"><with-param pos="2"/></call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="segle_num">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="regla: det num_romano secolo: il I secolo > el segle I">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num_romano"/>
        <pattern-item n="secolo_sg"/>
      </pattern>
      <action>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <call-macro n="f_concord2"><with-param pos="3"/><with-param pos="1"/></call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <out>
          <chunk name="det_segle_num">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/>
	      <clip pos="1" side="tl" part="a_det"/>
	      <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
	      <clip pos="1" side="tl" part="gen_mf"/>         
	      <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
	      <clip pos="1" side="tl" part="nbr_sp"/>         
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="3" side="tl" part="whole"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="regla: pr det num_romano cnjcoo det num_romano secolo: tra il XII e il XIV secolo > entre el segle XII i el XIV">
      <pattern>
        <pattern-item n="pr"/>
        <pattern-item n="det"/>
        <pattern-item n="num_romano"/>
        <pattern-item n="cnjcoo"/>
        <pattern-item n="det"/>
        <pattern-item n="num_romano"/>
        <pattern-item n="secolo"/>
      </pattern>
      <action>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <out>
          <chunk name="pr_det_segle_num_cnjcoo_det_num">
            <tags>
              <tag><lit-tag v="adv"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lem"/>
              <clip pos="2" side="tl" part="a_det"/>
              <clip pos="2" side="tl" part="gen"/>         
              <clip pos="2" side="tl" part="nbr"/>         
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="7" side="tl" part="lemh"/>
              <clip pos="7" side="tl" part="tags"/>
              <clip pos="7" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="3" side="tl" part="whole"/>
            </lu>
            <b pos="4"/>
            <lu>
              <clip pos="4" side="tl" part="whole"/>
            </lu>
            <b pos="5"/>
            <lu>
              <clip pos="5" side="tl" part="lemh"/>
              <clip pos="5" side="tl" part="tags"/>
              <clip pos="5" side="tl" part="lemq"/>
            </lu>
            <b pos="6"/>
            <lu>
              <clip pos="6" side="tl" part="whole"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: DET NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu> 
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/> 
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: DET TOP: un'Italia > una Itàlia">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="top"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <and>
                <equal><clip pos="1" side="tl" part="a_det"/><lit-tag v="det.def"/></equal>
                <in>
                  <clip pos="2" side="sl" part="lem"/>
                  <list n="paisos_regions"/>
                </in>
              </and>
            </test>
            <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
            <out>
              <chunk name="top" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/> 
                  <clip pos="2" side="tl" part="a_nom"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>         
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="det_top" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SN"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lem"/> 
                  <clip pos="1" side="tl" part="a_det"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>         
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>         
                </lu> 
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="lemh"/> 
                  <clip pos="2" side="tl" part="a_nom"/>
                  <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="2" side="tl" part="gen_mf"/>         
                  <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="2" side="tl" part="nbr_sp"/>
                  <clip pos="2" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>


    <rule comment="REGLA: DET ORG">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="org"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="det_org" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu> 
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/> 
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: PREDET DET NOM">
      <pattern>
        <pattern-item n="predet"/>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="predet_det_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
            </lu> 
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/> 
              <clip pos="2" side="tl" part="a_det"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
            </lu> 
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/> 
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: DET NUM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det_num" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
            </lu> 
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lem"/> 
              <clip pos="2" side="tl" part="a_num"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: soli NUM">
      <pattern>
        <pattern-item n="soli"/>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="adv" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <lit v="només"/>
              </get-case-from>
              <lit-tag v="adv"/>
            </lu> 
          </chunk>
          <b pos="1"/>
          <chunk name="det_num">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="2" side="tl" part="lem"/> 
              <clip pos="2" side="tl" part="a_num"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="regla: giorno mese: 26 maggio > 26 de maig ">
      <pattern>
        <pattern-item n="giorno"/>
        <pattern-item n="mese"/>
      </pattern>
      <action>
        <call-macro n="f_salvar_gen_num"></call-macro>
        <call-macro n="f_concord1"><with-param pos="2"/></call-macro>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <call-macro n="f_giorno"><with-param pos="1"/></call-macro>
        <out>
          <chunk name="dia-de-mes">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <var n="numerodia"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_restaurar_gen_num"></call-macro>
      </action>
    </rule>

    <rule comment="REGLA: NUM NOM">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>
        <choose> <!-- 1,158 milione > 1,158 milions -->
          <when>
            <test>
              <and>
                <not><equal><clip pos="1" side="sl" part="lem"/><lit v="1"/></equal></not>
                <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="milione"/></equal>
              </and>
            </test>
            <let><var n="numero"/><lit-tag v="pl"/></let>
            <let><clip pos="2" side="tl" part="numero"/><lit-tag v="pl"/></let>
          </when>
        </choose>
        <out>  
          <chunk name="num_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>   
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_num"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu> 
            <b pos="1"/>
            <lu>     
              <clip pos="2" side="tl" part="lemh"/> 
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: NOM ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>        
        <out>
          <chunk name="nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/> 
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: ADJ NOM">
      <pattern>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>        
        <out>
          <chunk name="adj_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/> 
              <clip pos="1" side="tl" part="a_adj"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: ADJ NOM ADJ">
      <pattern>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>        
        <out>
          <chunk name="adj_nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/> 
              <clip pos="1" side="tl" part="a_adj"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu> 
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/> 
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: DET ADJ ADJ NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adv_preadv"/>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="4"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>        
        <out>
          <chunk name="det_adv_adj_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="whole"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu> 
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/> 
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="4" side="tl" part="gen_mf"/>         
              <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="4" side="tl" part="nbr_sp"/>         
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>


    <rule comment="regla: det giorno mese: il 26 maggio > el 26 de maig ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="giorno"/>
        <pattern-item n="mese"/>
      </pattern>
      <action>
        <call-macro n="f_salvar_gen_num"></call-macro>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <call-macro n="f_chunk_tags"><with-param pos="1"/></call-macro>
        <call-macro n="f_concord1"><with-param pos="3"/></call-macro>
        <call-macro n="f_giorno"><with-param pos="2"/></call-macro>
        <out>
          <chunk name="det-dia-de-mes">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/>
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <var n="numerodia"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_restaurar_gen_num"></call-macro>
      </action>
    </rule>

    <rule comment="DET NUM NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="det_num_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lem"/> 
              <clip pos="2" side="tl" part="a_num"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/> 
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="DET NUM ADJ NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="adj"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_concord4">
          <with-param pos="4"/>
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <chunk name="det_num_adj_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lem"/> 
              <clip pos="2" side="tl" part="a_num"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/> 
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/> 
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="4" side="tl" part="gen_mf"/>         
              <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="4" side="tl" part="nbr_sp"/>         
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="DET NUM NOM ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord4">
          <with-param pos="3"/>
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="4"/>
        </call-macro>
        <out>
          <chunk name="det_num_nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lem"/> 
              <clip pos="2" side="tl" part="a_num"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/> 
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/> 
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="4" side="tl" part="gen_mf"/>         
              <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="4" side="tl" part="nbr_sp"/>         
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: NOM ADJ ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>        
        <out>
          <chunk name="nom_adj_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/> 
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu> 
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>
    
    <rule comment="REGLA: DET NOM ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>        
        <out>
          <chunk name="det_nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/> 
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>
    
    <rule comment="REGLA: DET NOM ADJ ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord4">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="4"/>
          <with-param pos="1"/>
        </call-macro>        
        <out>
          <chunk name="det_nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/> 
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu> 
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="4" side="tl" part="gen_mf"/>         
              <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="4" side="tl" part="nbr_sp"/>         
              <clip pos="4" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>
    
    <rule comment="REGLA: DET TOP ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="top"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>        
        <out>
          <chunk name="det_top_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/> 
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>
    
    <rule comment="REGLA: DET TOP ADJ ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="top"/>
        <pattern-item n="adj"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord4">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="4"/>
          <with-param pos="1"/>
        </call-macro>        
        <out>
          <chunk name="det_top_adj_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/> 
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu> 
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="4" side="tl" part="gen_mf"/>         
              <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="4" side="tl" part="nbr_sp"/>         
              <clip pos="4" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>
    
    <rule comment="REGLA: DET ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>        
        <out>
          <chunk name="det_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SA"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>
    
    <rule comment="REGLA: DET ADV ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adv"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>        
        <out>
          <chunk name="det_adv_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SA"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="whole"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>
    
    <rule comment="REGLA: DET solito NOM (il solito partito > el partit habitual)">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="solito"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>        
        <out>
          <chunk name="det_adj_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/> 
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>
    

    <rule comment="REGLA: DET ADJ NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="1"/>
        </call-macro>        
        <out>
          <chunk name="det_adj_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu> 
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/> 
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>
    

    <rule comment="REGLA: DET ADJ NOM ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord4">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="4"/>
          <with-param pos="1"/>
        </call-macro>        
        <out>
          <chunk name="det_adj_nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu> 
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/> 
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/> 
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="4" side="tl" part="gen_mf"/>         
              <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="4" side="tl" part="nbr_sp"/>         
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>
    

    <rule comment="REGLA: DET ADJ cnj ADJ NOM">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="adjec"/>
        <pattern-item n="cnjcoo"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="f_concord4">
          <with-param pos="5"/>
          <with-param pos="2"/>
          <with-param pos="4"/>
          <with-param pos="1"/>
        </call-macro>        
        <out>
          <chunk name="det_adj_cnjcoo_adj_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu> 
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="whole"/>
            </lu> 
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="4" side="tl" part="gen_mf"/>         
              <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="4" side="tl" part="nbr_sp"/>         
              <clip pos="4" side="tl" part="lemq"/>
            </lu> 
            <b pos="4"/>
            <lu>
              <clip pos="5" side="tl" part="lemh"/> 
              <clip pos="5" side="tl" part="a_nom"/>
              <clip pos="5" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="5" side="tl" part="gen_mf"/>         
              <clip pos="5" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="5" side="tl" part="nbr_sp"/>         
              <clip pos="5" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>
    
    <rule comment="REGLA: NUM ADV ADJ NOM">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="adv"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="4"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <out>
          <chunk name="num_adv_adj_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_num"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="whole"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu> 
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/> 
              <clip pos="4" side="tl" part="a_nom"/>
              <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="4" side="tl" part="gen_mf"/>         
              <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="4" side="tl" part="nbr_sp"/>         
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>
    
    <rule comment="REGLA: NUM ADJ NOM">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="3"/>
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="num_adj_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_num"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu> 
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/> 
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>
    
    <rule comment="REGLA: NUM ADJ cnj ADJ NOM">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="adjec"/>
        <pattern-item n="cnjcoo"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="f_concord4">
          <with-param pos="5"/>
          <with-param pos="2"/>
          <with-param pos="4"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="num_adj_cnjcoo_adj_nom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_num"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu> 
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="whole"/>
            </lu> 
            <b pos="3"/>
            
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="4" side="tl" part="gen_mf"/>         
              <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="4" side="tl" part="nbr_sp"/>         
              <clip pos="4" side="tl" part="lemq"/>
            </lu> 
            <b pos="4"/>
            <lu>
              <clip pos="5" side="tl" part="lemh"/> 
              <clip pos="5" side="tl" part="a_nom"/>
              <clip pos="5" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="5" side="tl" part="gen_mf"/>         
              <clip pos="5" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="5" side="tl" part="nbr_sp"/>         
              <clip pos="5" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>
    
    
    <rule comment="REGLA: NUM NOM ADJ">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>        
        <choose> <!-- 1,158 milione > 1,158 milions -->
          <when>
            <test>
              <and>
                <not><equal><clip pos="1" side="sl" part="lem"/><lit v="1"/></equal></not>
                <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="milione"/></equal>
              </and>
            </test>
            <let><var n="numero"/><lit-tag v="pl"/></let>
            <let><clip pos="2" side="tl" part="numero"/><lit-tag v="pl"/></let>
          </when>
        </choose>
        <out>
          <chunk name="num_nom_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_num"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/> 
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>
    
    <rule comment="REGLA: DET NOM ADV ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adv_preadv"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="4"/>
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="det_nom_adv_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/> 
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="whole"/> 
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="4" side="tl" part="gen_mf"/>         
              <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="4" side="tl" part="nbr_sp"/>         
              <clip pos="4" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>
    
    <rule comment="REGLA: NOM ADV ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adv_preadv"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>        
        <out>
          <chunk name="det_nom_adv_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/> 
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="whole"/> 
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: NUM NOM ADV ADJ">
      <pattern>
        <pattern-item n="num"/>
        <pattern-item n="nom"/>
        <pattern-item n="adv_preadv"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="4"/>
        </call-macro>
        <choose> <!-- 1,158 milione > 1,158 milions -->
          <when>
            <test>
              <and>
                <not><equal><clip pos="1" side="sl" part="lem"/><lit v="1"/></equal></not>
                <equal caseless="yes"><clip pos="2" side="sl" part="lemh"/><lit v="milione"/></equal>
              </and>
            </test>
            <let><var n="numero"/><lit-tag v="pl"/></let>
            <let><clip pos="2" side="tl" part="numero"/><lit-tag v="pl"/></let>
          </when>
        </choose>
        <out>
          <chunk name="num_nom_adv_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/> 
              <clip pos="1" side="tl" part="a_num"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/> 
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="whole"/> 
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="4" side="tl" part="gen_mf"/>         
              <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="4" side="tl" part="nbr_sp"/>         
              <clip pos="4" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>
    
    <rule comment="REGLA: NOM ADJ cnjcoo ADJ">
      <pattern>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="cnjcoo"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="4"/>
        </call-macro>        
        <out>
          <chunk name="nom_adj_cnjcoo_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/> 
              <clip pos="1" side="tl" part="a_nom"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu> 
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="whole"/> 
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="4" side="tl" part="gen_mf"/>         
              <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="4" side="tl" part="nbr_sp"/>         
              <clip pos="4" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>
    
    <rule comment="REGLA: DET NOM ADJ cnjcoo ADJ">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="cnjcoo"/>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord4">
          <with-param pos="2"/>
          <with-param pos="1"/>
          <with-param pos="3"/>
          <with-param pos="5"/>
        </call-macro>        
        <out>
          <chunk name="det_nom_adj_cnjcoo_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/> 
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>         
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>         
              <clip pos="3" side="tl" part="lemq"/>
            </lu> 
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="whole"/> 
            </lu>
            <b pos="4"/>
            <lu>
              <clip pos="5" side="tl" part="lemh"/>
              <clip pos="5" side="tl" part="a_adj"/>
              <clip pos="5" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="5" side="tl" part="gen_mf"/>         
              <clip pos="5" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="5" side="tl" part="nbr_sp"/>         
              <clip pos="5" side="tl" part="lemq"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>

    <!-- REGLES data (n'hi algunes més a dalt per donar-los preferència -->

    <rule comment="regla: mes anno: maggio 2017 > maig de 2017">
      <pattern>
        <pattern-item n="mese"/>
        <pattern-item n="anno"/>
      </pattern>
      <action>
        <call-macro n="f_salvar_gen_num"></call-macro>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <call-macro n="f_chunk_tags"><with-param pos="1"/></call-macro>
        <call-macro n="f_concord1"><with-param pos="1"/></call-macro>
        <out>
          <chunk name="mes-de-any">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_restaurar_gen_num"></call-macro>
      </action>
    </rule>

    <rule comment="regla: det mese anno: il maggio 2017 > el maig de 2017">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="mese"/>
        <pattern-item n="anno"/>
      </pattern>
      <action>
        <call-macro n="f_salvar_gen_num"></call-macro>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <call-macro n="f_chunk_tags"><with-param pos="2"/></call-macro>
        <call-macro n="f_concord2"><with-param pos="2"/><with-param pos="1"/></call-macro>
        <out>
          <chunk name="det-mes-de-any">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
	    <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_restaurar_gen_num"></call-macro>
      </action>
    </rule>

    <rule comment="regla: in det mese anno: nel maggio 2017 > el maig de 2017">
      <pattern>
        <pattern-item n="in"/>
        <pattern-item n="det"/>
        <pattern-item n="mese"/>
        <pattern-item n="anno"/>
      </pattern>
      <action>
        <call-macro n="f_salvar_gen_num"></call-macro>
        <call-macro n="f_concord2"><with-param pos="3"/><with-param pos="2"/></call-macro>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <chunk name="det-mes-de-any">
            <tags>
              <tag><lit-tag v="adv"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lemh"/>
              </get-case-from>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
	    <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="tags"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_restaurar_gen_num"></call-macro>
      </action>
    </rule>

    <rule comment="regla: in det giorno mese: nel 26 maggio > el 26 de maig ">
      <pattern>
        <pattern-item n="in"/>
        <pattern-item n="det"/>
        <pattern-item n="giorno"/>
        <pattern-item n="mese"/>
      </pattern>
      <action>
        <call-macro n="f_salvar_gen_num"></call-macro>
        <call-macro n="f_concord1"><with-param pos="4"/></call-macro>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <call-macro n="f_giorno"><with-param pos="3"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <chunk name="det-dia-de-mes">
            <tags>
              <tag><lit-tag v="adv"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lem"/>
              </get-case-from>
              <clip pos="2" side="tl" part="a_det"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="2"/>
            <lu>
              <var n="numerodia"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="tags"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_restaurar_gen_num"></call-macro>
      </action>
    </rule>

    <rule comment="regla: giorno mese anno: 26 maggio 2017 > 26 de maig de 2017">
      <pattern>
        <pattern-item n="giorno"/>
        <pattern-item n="mese"/>
        <pattern-item n="anno"/>
      </pattern>
      <action>
        <call-macro n="f_salvar_gen_num"></call-macro>
        <call-macro n="f_concord1"><with-param pos="2"/></call-macro>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <call-macro n="f_giorno"><with-param pos="1"/></call-macro>
        <out>
          <chunk name="dia-de-mes-de-any">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
            </tags>
            <lu>
              <var n="numerodia"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_restaurar_gen_num"></call-macro>
      </action>
    </rule>

    
    <rule comment="regla: det giorno mese anno: il 26 maggio 2017 > el 26 de maig 2017">
      <pattern>
        <pattern-item n="det"/>
        <pattern-item n="giorno"/>
        <pattern-item n="mese"/>
        <pattern-item n="anno"/>
      </pattern>
      <action>
        <call-macro n="f_salvar_gen_num"></call-macro>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <call-macro n="f_chunk_tags"><with-param pos="1"/></call-macro>
        <call-macro n="f_concord1"><with-param pos="3"/></call-macro>
        <call-macro n="f_giorno"><with-param pos="2"/></call-macro>
        <out>
          <chunk name="det-dia-de-mes-de-any">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/>
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="1"/>
            <lu>
              <var n="numerodia"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="tags"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_restaurar_gen_num"></call-macro>
      </action>
    </rule>

    <rule comment="regla: in det giorno mese anno: nel 26 maggio 2017 > el 26 de maig 2017">
      <pattern>
        <pattern-item n="in"/>
        <pattern-item n="det"/>
        <pattern-item n="giorno"/>
        <pattern-item n="mese"/>
        <pattern-item n="anno"/>
      </pattern>
      <action>
        <call-macro n="f_salvar_gen_num"></call-macro>
        <call-macro n="f_concord1"><with-param pos="4"/></call-macro>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <call-macro n="f_giorno"><with-param pos="3"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <chunk name="det-dia-de-mes-de-any">
            <tags>
              <tag><lit-tag v="adv"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lem"/>
              </get-case-from>
              <clip pos="2" side="tl" part="lem"/>
              <clip pos="2" side="tl" part="a_det"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>         
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>         
            </lu>
            <b pos="2"/>
            <lu>
              <var n="numerodia"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="tags"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
            <b/>
            <lu>
              <lit v="de"/>
              <lit-tag v="pr"/>
            </lu>
            <b pos="4"/>
            <lu>
              <clip pos="5" side="tl" part="lemh"/>
              <clip pos="5" side="tl" part="tags"/>
              <clip pos="5" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_restaurar_gen_num"></call-macro>
      </action>
    </rule>

    <rule comment="regla: in det anno: nel 2017 > el 2017">
      <pattern>
        <pattern-item n="in"/>
        <pattern-item n="il_msg"/>
        <pattern-item n="anno"/>
      </pattern>
      <action>
        <call-macro n="f_salvar_gen_num"></call-macro>
        <call-macro n="f_concord2"><with-param pos="3"/><with-param pos="2"/></call-macro>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <chunk name="det-any">
            <tags>
              <tag><lit-tag v="adv"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lemh"/>
              </get-case-from>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_restaurar_gen_num"></call-macro>
      </action>
    </rule>

    <rule comment="regla: in mese: in giugno el juny">
      <pattern>
        <pattern-item n="in"/>
        <pattern-item n="mese"/>
      </pattern>
      <action>
        <call-macro n="f_salvar_gen_num"></call-macro>
        <call-macro n="f_concord1"><with-param pos="2"/></call-macro>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <out>
          <chunk name="det-nom">
            <tags>
              <tag><lit-tag v="adv"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <lit v="el"/>
              </get-case-from>
              <lit-tag v="det.def"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_restaurar_gen_num"></call-macro>
      </action>
    </rule>

    <rule comment="regla: in mese: in estate > a l'estiu">
      <pattern>
        <pattern-item n="in"/>
        <pattern-item n="stagione"/>
      </pattern>
      <action>
        <call-macro n="f_salvar_gen_num"></call-macro>
        <call-macro n="f_concord1"><with-param pos="2"/></call-macro>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <out>
          <chunk name="det-nom">
            <tags>
              <tag><lit-tag v="adv"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <lit v="a"/>
              </get-case-from>
              <lit-tag v="pr"/>
            </lu>
            <b pos="1"/>
            <lu>
              <get-case-from pos="1">
                <lit v="el"/>
              </get-case-from>
              <lit-tag v="det.def"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
            <b/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_restaurar_gen_num"></call-macro>
      </action>
    </rule>

    <rule comment="regla: num periodo fa: tre anni fa > fa tres anys">
      <pattern>
        <pattern-item n="num_det_adj"/>
        <pattern-item n="periodo"/>
        <pattern-item n="fa"/>
      </pattern>
      <action>
        <call-macro n="f_salvar_gen_num"></call-macro>
        <call-macro n="f_concord2"><with-param pos="2"/><with-param pos="1"/></call-macro>
        <call-macro n="firstWord"><with-param pos="1"/></call-macro>
        <out>
          <chunk name="fa-num-nom">
            <tags>
              <tag><lit-tag v="SAdv"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <clip pos="3" side="tl" part="lemh"/>
              </get-case-from>
              <clip pos="3" side="tl" part="tags"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="1"/>
            <lu>
              <get-case-from pos="2">
                <clip pos="1" side="tl" part="lemh"/>
              </get-case-from>
              <clip pos="1" side="tl" part="tags"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="tags"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <call-macro n="f_restaurar_gen_num"></call-macro>
      </action>
    </rule>


    <rule comment="REGLA: DET (quan no acompanya res o va amb desconeguda)">
      <pattern>
        <pattern-item n="det"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SA"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="REGLA: NUM. Si pot ser 'm' o 'f', sortirà com a GD. Caldrà tractar-ho en interchunk o postchunk.">
      <pattern>
        <pattern-item n="num"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="num" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="NUM"/></tag>
              <tag><clip pos="1" side="tl" part="gen"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
            </tags>
            <lu>   
              <clip pos="1" side="tl" part="lem"/>
              <clip pos="1" side="tl" part="a_num"/> 
              <clip pos="1" side="tl" part="gen" link-to="2"/>
              <clip pos="1" side="tl" part="nbr" link-to="3"/>
            </lu> 
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: ADJECTIU (quan no acompanya res o va amb desconeguda)">
      <pattern>
        <pattern-item n="adj"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SA"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_adj"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="REGLA: ADJ_SUP (quan no acompanya res o va amb desconeguda)">
      <pattern>
        <pattern-item n="adjsup"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when>
            <test>
              <or>
                <equal><clip pos="1" side="tl" part="a_adj"/><lit-tag v="adj.sup"/></equal>
                <equal><clip pos="1" side="tl" part="a_adj"/><lit-tag v="adj.ind.sup"/></equal>
              </or>
            </test>
            <out>
              <chunk name="adjsup" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SA"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_adj"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk name="adv_adj" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SA"/></tag>
                  <tag><var n="genero"/></tag>
                  <tag><var n="numero"/></tag>
                  <tag><var n="genero_sl"/></tag>
                  <tag><var n="numero_sl"/></tag>
                </tags>
                <lu>
                  <lit v="molt"/>
                  <lit-tag v="adv"/>
                </lu>
                <b/>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_adj"/>
                  <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
                  <clip pos="1" side="tl" part="gen_mf"/>
                  <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
                  <clip pos="1" side="tl" part="nbr_sp"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <!--  REGLES DE COMPARACIÓ -->

    <rule comment="REGLA: più/meno adv di (più presto di > més ràpid que)">
      <pattern>
        <pattern-item n="piu_meno"/>
        <pattern-item n="adv"/>
        <pattern-item n="di"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="mes_adv" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SAdv"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/> 
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="whole"/>
            </lu>
          </chunk>
          <b pos="2"/>
          <chunk name="cnjsub">
            <tags>
              <tag><lit-tag v="cnjsub"/></tag>
            </tags>
            <lu>
              <lit v="que"/>
              <lit-tag v="cnjsub"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="REGLA: più/meno adj di (più veloci di > més ràpid que)">
      <pattern>
        <pattern-item n="piu_meno"/>
        <pattern-item n="adjec"/>
        <pattern-item n="di"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <out>
          <chunk name="mes_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SA"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/> 
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="2"/>
          <chunk name="cnjsub">
            <tags>
              <tag><lit-tag v="cnjsub"/></tag>
            </tags>
            <lu>
              <lit v="que"/>
              <lit-tag v="cnjsub"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="REGLA: il più/meno adj di (il più veloce di > el més ràpid de)">
      <pattern>
        <pattern-item n="det_def"/>
        <pattern-item n="piu_meno"/>
        <pattern-item n="adjec"/>
        <pattern-item n="di"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord2">
          <with-param pos="3"/>
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="4" side="tl" part="lem"/></let>
        <out>
          <chunk name="el_mes_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SA"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu> 
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="whole"/> 
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="3"/>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="pr"/></tag>
            </tags>
            <lu>
              <clip pos="4" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="REGLA: il NOM più/meno adj di (la macchina più veloce di > el cotxe més ràpid de)">
      <pattern>
        <pattern-item n="det_def"/>
        <pattern-item n="nom"/>
        <pattern-item n="piu_meno"/>
        <pattern-item n="adjec"/>
        <pattern-item n="di"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord3">
          <with-param pos="2"/>
          <with-param pos="4"/>
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="5" side="tl" part="lem"/></let>
        <out>
          <chunk name="el_nom_mes_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu> 
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="whole"/> 
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/>
              <clip pos="4" side="tl" part="a_adj"/>
              <clip pos="4" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="4" side="tl" part="gen_mf"/>
              <clip pos="4" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="4" side="tl" part="nbr_sp"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="4"/>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="pr"/></tag>
            </tags>
            <lu>
              <clip pos="5" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="REGLA: il ADJ NOM più/meno adj di (la seconda macchina più veloce di > el segon cotxe més ràpid de)">
      <pattern>
        <pattern-item n="det_def"/>
        <pattern-item n="adjec"/>
        <pattern-item n="nom"/>
        <pattern-item n="piu_meno"/>
        <pattern-item n="adjec"/>
        <pattern-item n="di"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_concord4">
          <with-param pos="3"/>
          <with-param pos="2"/>
          <with-param pos="5"/>
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="6" side="tl" part="lem"/></let>
        <out>
          <chunk name="el_adj_nom_mes_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu> 
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_adj"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_nom"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="whole"/> 
            </lu>
            <b pos="4"/>
            <lu>
              <clip pos="5" side="tl" part="lemh"/>
              <clip pos="5" side="tl" part="a_adj"/>
              <clip pos="5" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="5" side="tl" part="gen_mf"/>
              <clip pos="5" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="5" side="tl" part="nbr_sp"/>
              <clip pos="5" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="5"/>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="pr"/></tag>
            </tags>
            <lu>
              <clip pos="6" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="REGLA: il NOM ADJ più/meno adj di (la macchina italiana più veloce di > el cotxe italià més ràpid de)">
      <pattern>
        <pattern-item n="det_def"/>
        <pattern-item n="nom"/>
        <pattern-item n="adjec"/>
        <pattern-item n="piu_meno"/>
        <pattern-item n="adjec"/>
        <pattern-item n="di"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord4">
          <with-param pos="2"/>
          <with-param pos="3"/>
          <with-param pos="5"/>
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="6" side="tl" part="lem"/></let>
        <out>
          <chunk name="el_adj_nom_mes_adj" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SN"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lem"/> 
              <clip pos="1" side="tl" part="a_det"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>         
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>         
            </lu> 
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_nom"/>
              <clip pos="2" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="2" side="tl" part="gen_mf"/>
              <clip pos="2" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="2" side="tl" part="nbr_sp"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_adj"/>
              <clip pos="3" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="3" side="tl" part="gen_mf"/>
              <clip pos="3" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="3" side="tl" part="nbr_sp"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="whole"/> 
            </lu>
            <b pos="4"/>
            <lu>
              <clip pos="5" side="tl" part="lemh"/>
              <clip pos="5" side="tl" part="a_adj"/>
              <clip pos="5" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="5" side="tl" part="gen_mf"/>
              <clip pos="5" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="5" side="tl" part="nbr_sp"/>
              <clip pos="5" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="5"/>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="pr"/></tag>
            </tags>
            <lu>
              <clip pos="6" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <!--  FI REGLES DE COMPARACIÓ -->


    <!--  SINTAGMES VERBALS -->


    <rule comment="REGLA: pp (quan no acompanya res o va amb desconeguda)">
      <pattern>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <!--   <choose>
             <when> 
             <test>
             <and>
             <equal caseless="yes">
             <clip pos="1" side="tl" part="lem"/>
             <lit v="haver"/>
             </equal>
             <equal>
             <clip pos="1" side="tl" part="temps"/>
             <lit-tag v="pp"/>
             </equal>
             </and>
             </test>
             <let>
             <clip pos="1" side="tl" part="gen"/>
             <lit-tag v="m"/>
             </let>
             <let>
             <clip pos="1" side="tl" part="nbr"/>
             <lit-tag v="sg"/>
             </let>
             </when>
             </choose>-->

        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <out>
          <chunk name="pp" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SA"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>


    <rule comment="REGLA: PRETIND">
      <pattern>
        <pattern-item n="pretind"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_pretind">
          <with-param pos="1"/>
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <var n="verbfinal"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: ifi loro.prn > els vfin (permisse loro > els va permetre)">
      <pattern>
        <pattern-item n="pretind"/>
        <pattern-item n="lui_mf_pl"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_pretind">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk name="pronom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
              <tag><clip pos="2" side="tl" part="pers"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lemh"/>
              </get-case-from>
              <clip pos="2" side="tl" part="tipus_prn"/>
              <clip pos="2" side="tl" part="pers"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <var n="verbfinal"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: prnpro si vfin (no ifi): vi si trova > s'hi trova">
      <pattern>
        <pattern-item n="prnpro"/>
        <pattern-item n="si"/>
        <pattern-item n="vfin_no_ifi"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="3" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="3" side="tl" part="a_verb"/></tag>
              <tag><clip pos="3" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lem"/>
              </get-case-from>
              <clip pos="2" side="tl" part="tags"/>
            </lu>
            <b pos="1"/>
            <lu>
              <get-case-from pos="2">
                <clip pos="1" side="tl" part="lem"/>
              </get-case-from>
              <clip pos="1" side="tl" part="tags"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/>
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="pers"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: prnpro si PRETIND: vi si trovò > s'hi va trovar">
      <pattern>
        <pattern-item n="prnpro"/>
        <pattern-item n="si"/>
        <pattern-item n="pretind"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_pretind">
          <with-param pos="3"/>
          <with-param pos="3"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="3" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="3" side="tl" part="a_verb"/></tag>
              <tag><clip pos="3" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lem"/>
              </get-case-from>
              <clip pos="2" side="tl" part="tags"/>
            </lu>
            <b pos="1"/>
            <lu>
              <get-case-from pos="2">
                <clip pos="1" side="tl" part="lem"/>
              </get-case-from>
              <clip pos="1" side="tl" part="tags"/>
            </lu>
            <b pos="2"/>
            <lu>
              <var n="verbfinal"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>


  <rule comment="REGLA: vbser + pp (sono andata > he anat)">
      <pattern>
        <pattern-item n="vbser"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_vauxiliar">
          <with-param pos="1"/>
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_pretind">
          <with-param pos="1"/>
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="2" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <var n="verbfinal"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/> 
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

  <rule comment="REGLA: vbser + pp + da (passiu: sono servito da > sóc servit per)">
      <pattern>
        <pattern-item n="vbser"/>
        <pattern-item n="pp"/>
        <pattern-item n="da"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_pretind">
          <with-param pos="1"/>
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="2" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <var n="verbfinal"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/> 
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="2"/>
        </out>
        <let><var n="lemma"/><clip pos="3" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="pr"/></tag>
            </tags>
            <lu>
              <clip pos="3" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

  <rule comment="REGLA: vbser + adv + pp + da (passiu: sono bene servito da > sóc ben servit per)">
      <pattern>
        <pattern-item n="vbser"/>
        <pattern-item n="adv"/>
        <pattern-item n="pp"/>
        <pattern-item n="da"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_pretind">
          <with-param pos="1"/>
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="3" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="3" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <var n="verbfinal"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="whole"/> 
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/> 
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="3"/>
        </out>
        <let><var n="lemma"/><clip pos="4" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="pr"/></tag>
            </tags>
            <lu>
              <clip pos="4" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

  <rule comment="regla: c'è stato, ci sono state > hi ha hagut (tots els temps simples)">
    <pattern>
      <pattern-item n="ci"/>
      <pattern-item n="ser_p3_no_ifi"/>
      <pattern-item n="vbser_pp"/>
    </pattern>
    <action>
      <call-macro n="f_concord1">
        <with-param pos="2"/>
      </call-macro>
      <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vaux"/></let>
      <out>
        <chunk name="hi_ha">
          <tags>
            <tag><lit-tag v="SV"/></tag>
            <tag><clip pos="2" side="tl" part="a_verb"/></tag>
            <tag><clip pos="2" side="tl" part="temps"/></tag>
            <tag><var n="numero"/></tag>
          </tags>
          <lu>
            <get-case-from pos="1">
              <lit v="hi"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="haver"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="pers"/>
            <lit-tag v="sg"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <lit v="haver"/>
            </get-case-from>
            <lit-tag v="vbhaver.pp.m.sg"/>
          </lu>
        </chunk>
      </out>
    </action>
  </rule>


  <rule comment="regla: c'è stata separata > hi ha estat separada (tots els temps simples)">
    <pattern>
      <pattern-item n="ci"/>
      <pattern-item n="ser_p3_no_ifi"/>
      <pattern-item n="vbser_pp"/>
      <pattern-item n="pp"/>
    </pattern>
    <action>
      <call-macro n="f_concord1">
        <with-param pos="3"/>
      </call-macro>
      <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vaux"/></let>
      <out>
        <chunk name="prnpro_aux_serpp_pp">
          <tags>
            <tag><lit-tag v="SV"/></tag>
            <tag><clip pos="4" side="tl" part="a_verb"/></tag>
            <tag><clip pos="4" side="tl" part="temps"/></tag>
            <tag><var n="genero"/></tag>
            <tag><var n="numero"/></tag>
          </tags>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="haver"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="pers"/>
            <clip pos="2" side="tl" part="nbr_sense_sp" link-to="5"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <lit-tag v="m"/>
            <lit-tag v="sg"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="lemh"/>
            <clip pos="4" side="tl" part="a_verb"/>
            <clip pos="4" side="tl" part="temps"/>
            <clip pos="4" side="tl" part="gen_sense_mf" link-to="4"/>
            <clip pos="4" side="tl" part="nbr_sense_sp" link-to="5"/>
            <clip pos="4" side="tl" part="lemq"/>
          </lu>
        </chunk>
      </out>
    </action>
  </rule>

  <rule comment="regla: c'è stata effettivamente separata > hi ha estat efectivament separada (tots els temps simples)">
    <pattern>
      <pattern-item n="ci"/>
      <pattern-item n="ser_p3_no_ifi"/>
      <pattern-item n="vbser_pp"/>
      <pattern-item n="adv_preadv"/>
      <pattern-item n="pp"/>
    </pattern>
    <action>
      <call-macro n="f_concord1">
        <with-param pos="3"/>
      </call-macro>
      <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vaux"/></let>
      <out>
        <chunk name="prnpro_aux_serpp_adv_pp">
          <tags>
            <tag><lit-tag v="SV"/></tag>
            <tag><clip pos="5" side="tl" part="a_verb"/></tag>
            <tag><clip pos="5" side="tl" part="temps"/></tag>
            <tag><var n="genero"/></tag>
            <tag><var n="numero"/></tag>
          </tags>
          <lu>
            <clip pos="1" side="tl" part="whole"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="haver"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="pers"/>
            <clip pos="2" side="tl" part="nbr_sense_sp" link-to="5"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
          <b pos="2"/>
          <lu>
            <clip pos="3" side="tl" part="lemh"/>
            <clip pos="3" side="tl" part="a_verb"/>
            <clip pos="3" side="tl" part="temps"/>
            <lit-tag v="m"/>
            <lit-tag v="sg"/>
            <clip pos="3" side="tl" part="lemq"/>
          </lu>
          <b pos="3"/>
          <lu>
            <clip pos="4" side="tl" part="whole"/>
          </lu>
          <b pos="4"/>
          <lu>
            <clip pos="5" side="tl" part="lemh"/>
            <clip pos="5" side="tl" part="a_verb"/>
            <clip pos="5" side="tl" part="temps"/>
            <clip pos="5" side="tl" part="gen_sense_mf" link-to="4"/>
            <clip pos="5" side="tl" part="nbr_sense_sp" link-to="5"/>
            <clip pos="5" side="tl" part="lemq"/>
          </lu>
        </chunk>
      </out>
    </action>
  </rule>

  <rule comment="regla: ci fu stato > hi va haver hagut">
    <pattern>
    <pattern-item n="ci"/>
    <pattern-item n="ser_p3_ifi"/>
    <pattern-item n="vbser_pp"/>
    </pattern>
    <action>
      <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vaux"/></let>
      <out>
        <chunk name="hi_va_haver_pp">
          <tags>
            <tag><lit-tag v="SV"/></tag>
            <tag><clip pos="2" side="tl" part="a_verb"/></tag>
            <tag><clip pos="2" side="tl" part="temps"/></tag>
            <tag><var n="numero"/></tag>
          </tags>
          <lu>
            <get-case-from pos="1">
              <lit v="hi"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="anar"/>
            </get-case-from>
            <lit-tag v="vaux"/>
            <clip pos="2" side="tl" part="pers"/>
            <lit-tag v="sg"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="haver"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="inf"/>
          </lu>
          <b pos="2"/>
          <lu>
            <get-case-from pos="3">
              <lit v="haver"/>
            </get-case-from>
            <lit-tag v="vbhaver.pp.m.sg"/>
          </lu>
        </chunk>
      </out>
    </action>
  </rule>

    <rule comment="REGLA: ci vbser + pp (ci sono andata: he anat)">
      <pattern>
        <pattern-item n="ci"/>
        <pattern-item n="vbser"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_vauxiliar">
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_pretind">
          <with-param pos="2"/>
          <with-param pos="2"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="3" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="3" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="sl" part="temps"/></tag>
            </tags>
             <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <var n="verbfinal"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/> 
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

  <rule comment="REGLA: prnpro + vbaux + pp">
      <pattern>
        <pattern-item n="prnpro"/>
        <pattern-item n="vbaux"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_vauxiliar_pron">
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_pretind">
          <with-param pos="2"/>
          <with-param pos="2"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="3" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="3" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="sl" part="temps"/></tag>
            </tags>
             <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <var n="verbfinal"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/> 
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>

          </chunk>
        </out>
      </action>
    </rule>

  <rule comment="REGLA: prnpro + vbaux + adv + pp">
      <pattern>
        <pattern-item n="prnpro"/>
        <pattern-item n="vbaux"/>
        <pattern-item n="adv"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_vauxiliar_pron">
          <with-param pos="1"/>
          <with-param pos="2"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_pretind">
          <with-param pos="2"/>
          <with-param pos="2"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="4" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="4" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="sl" part="temps"/></tag>
            </tags>
             <lu>
              <clip pos="1" side="tl" part="whole"/>
            </lu>
            <b pos="1"/>
            <lu>
              <var n="verbfinal"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/> 
              <clip pos="4" side="tl" part="a_verb"/>
              <clip pos="4" side="tl" part="temps"/>
              <clip pos="4" side="tl" part="gen"/>
              <clip pos="4" side="tl" part="nbr"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="3" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: prnpro si vbaux pp: vi si ha trovato > s'hi ha trovat">
      <pattern>
        <pattern-item n="prnpro"/>
        <pattern-item n="si"/>
        <pattern-item n="vbaux"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_vauxiliar_pron">
          <with-param pos="1"/>
          <with-param pos="3"/>
          <with-param pos="4"/>
        </call-macro>
        <call-macro n="f_pretind">
          <with-param pos="3"/>
          <with-param pos="3"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="4" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="4" side="tl" part="a_verb"/></tag>
              <tag><clip pos="3" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lem"/>
              </get-case-from>
              <clip pos="2" side="tl" part="tags"/>
            </lu>
            <b pos="1"/>
            <lu>
              <get-case-from pos="2">
                <clip pos="1" side="tl" part="lem"/>
              </get-case-from>
              <clip pos="1" side="tl" part="tags"/>
            </lu>
            <b pos="2"/>
            <lu>
              <var n="verbfinal"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="lemh"/> 
              <clip pos="4" side="tl" part="a_verb"/>
              <clip pos="4" side="tl" part="temps"/>
              <clip pos="4" side="tl" part="gen"/>
              <clip pos="4" side="tl" part="nbr"/>
              <clip pos="4" side="tl" part="lemq"/>
            </lu>

          </chunk>
        </out>
      </action>
    </rule>

  <rule comment="REGLA: vbaux + adv + pp"> <!-- "sono già andate. hanno già mangiato. sono già fatte: ja han anat. ja han menjat. ja són fetes-->
      <pattern>
        <pattern-item n="vbaux"/>
        <pattern-item n="adv_preadv"/>
        <pattern-item n="pp"/>
      </pattern>
<!-- sortida: adverbi a l'inici.
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <out> aquest ordre estrany s per les maj
        <chunk name="SAdv" case="caseFirstWord">
          <tags>
            <tag><clip pos="2" side="tl" part="a_adv"/></tag>
          </tags>
          <lu>
            <get-case-from pos="1">
              <clip pos="2" side="tl" part="lem"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_adv"/>
          </lu>
        </chunk>
        <b pos="1"/>
        </out>
          <choose>
            <when>
              <test>
                <equal>
                  <case-of pos="1" side="sl" part="lemh"/>
                  <lit v="Aa"/>
                </equal>
              </test>
              <modify-case>
                <clip pos="1" side="sl" part="lemh"/>
                <lit v="aa"/>
              </modify-case>
            </when>
          </choose>
        <call-macro n="f_vauxiliar">
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_pretind">
          <with-param pos="1"/>
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="3" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="3" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <var n="verbfinal"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/> 
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>

          </chunk>
        </out>
      </action>
    </rule>
-->
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_vauxiliar">
          <with-param pos="1"/>
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="f_pretind">
          <with-param pos="1"/>
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <var n="verbfinal"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="3" side="tl" part="lemh"/> 
              <clip pos="3" side="tl" part="a_verb"/>
              <clip pos="3" side="tl" part="temps"/>
              <clip pos="3" side="tl" part="gen"/>
              <clip pos="3" side="tl" part="nbr"/>
              <clip pos="3" side="tl" part="lemq"/>
            </lu>
            <b pos="2"/>
            <lu>
              <clip pos="2" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: prnpro si vbaux adv pp: vi si ha sempre trovato > s'hi ha sempre trovat">
      <pattern>
        <pattern-item n="prnpro"/>
        <pattern-item n="si"/>
        <pattern-item n="vbaux"/>
        <pattern-item n="adv"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_vauxiliar_pron">
          <with-param pos="1"/>
          <with-param pos="3"/>
          <with-param pos="5"/>
        </call-macro>
        <call-macro n="f_pretind">
          <with-param pos="3"/>
          <with-param pos="3"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="5" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="5" side="tl" part="a_verb"/></tag>
              <tag><clip pos="3" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lem"/>
              </get-case-from>
              <clip pos="2" side="tl" part="tags"/>
            </lu>
            <b pos="1"/>
            <lu>
              <get-case-from pos="2">
                <clip pos="1" side="tl" part="lem"/>
              </get-case-from>
              <clip pos="1" side="tl" part="tags"/>
            </lu>
            <b pos="2"/>
            <lu>
              <var n="verbfinal"/>
            </lu>
            <b pos="3"/>
            <lu>
              <clip pos="4" side="tl" part="whole"/> 
            </lu>
            <b pos="4"/>
            <lu>
              <clip pos="5" side="tl" part="lemh"/> 
              <clip pos="5" side="tl" part="a_verb"/>
              <clip pos="5" side="tl" part="temps"/>
              <clip pos="5" side="tl" part="gen"/>
              <clip pos="5" side="tl" part="nbr"/>
              <clip pos="5" side="tl" part="lemq"/>
            </lu>

          </chunk>
        </out>
      </action>
    </rule>

 
<!-- malgrat el que digui el diccionari, la transformació no és encertada
    <rule comment="REGLA: andare (no ifi) + pp">
      <pattern>
        <pattern-item n="andare_no_ifi"/>
        <pattern-item n="pp"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <lit v="haver"/>
              <lit-tag v="vbmod"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="pers"/>
              <clip pos="1" side="tl" part="nbr"/>
              <lit v="# de"/>
            </lu>
            <b pos="1"/>
            <lu>
              <clip pos="2" side="tl" part="lemh"/>
              <clip pos="2" side="tl" part="a_verb"/>
              <lit-tag v="inf"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>
-->

    <rule comment="REGLA: ci volere_p3sg_no_ifi: ci vuole > cal">
      <pattern>
        <pattern-item n="ci"/>
        <pattern-item n="volere_p3sg_no_ifi"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><lit v="caldre"/></let>
        <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="a_verb"/></tag>
              <tag><clip pos="2" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <lit v="caldre"/>
              </get-case-from>
              <clip pos="2" side="tl" part="a_verb"/>
              <clip pos="2" side="tl" part="temps"/>
              <clip pos="2" side="tl" part="pers"/>
              <clip pos="2" side="tl" part="nbr"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: vfin (no ifi)">
      <pattern>
        <pattern-item n="vfin_no_ifi"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
<!--
        <call-macro n="f_set_pron">
          <with-param pos="1"/>
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="print_pron">
        </call-macro>
-->
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="pers"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>


    <rule comment="REGLA: imp">
      <pattern>
        <pattern-item n="imp"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <choose>
          <when> <!-- devi prendere questo → has de prendre això -->
            <test>
              <or>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="avere"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="dovere"/>
                </equal>
                <equal caseless="yes">
                  <clip pos="1" side="sl" part="lem"/>
                  <lit v="bisognare"/>
                </equal>
              </or>
            </test>
            <let>
              <clip pos="1" side="tl" part="temps"/>
              <lit-tag v="pri"/>
            </let>
          </when>
        </choose>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk name="imp" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="pers"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: pprs">
      <pattern>
        <pattern-item n="pprs"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk name="pprs" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <lit v="que"/>
              <lit-tag v="rel.an.mf.sp"/>
            </lu>
            <b/>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <lit-tag v="prs"/>
              <lit-tag v="p3"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: vfin (no ifi) loro.prn > els vfin (permetteva loro > els permetia)">
      <pattern>
        <pattern-item n="vlexfin_no_ifi"/>
        <pattern-item n="lui_mf_pl"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk name="pronom" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="2" side="tl" part="tipus_prn"/></tag>
              <tag><clip pos="2" side="tl" part="pers"/></tag>
              <tag><clip pos="2" side="tl" part="gen"/></tag>
              <tag><clip pos="2" side="tl" part="nbr"/></tag>
            </tags>
            <lu>
              <get-case-from pos="1">
                <clip pos="2" side="tl" part="lemh"/>
              </get-case-from>
              <clip pos="2" side="tl" part="tipus_prn"/>
              <clip pos="2" side="tl" part="pers"/>
              <clip pos="2" side="tl" part="gen"/>
              <clip pos="2" side="tl" part="nbr"/>
              <clip pos="2" side="tl" part="lemq"/>
            </lu>
          </chunk>
          <b pos="1"/>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <get-case-from pos="2">
                <clip pos="1" side="tl" part="lemh"/>
              </get-case-from>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="pers"/>
              <clip pos="1" side="tl" part="nbr"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: inf">
      <pattern>
        <pattern-item n="inf"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: inf loro.prn > inf li.enc (per proporre loro > per proposar-los)">
      <pattern>
        <pattern-item n="inf_ger"/>
        <pattern-item n="lui_mf_pl"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <choose>
          <when>
            <test>
                <equal><clip pos="2" side="tl" part="tipus_prn"/><lit-tag v="prn.enc"/></equal>
            </test>
            <out>
              <chunk namefrom="lemma" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="sl" part="temps"/></tag>
                </tags>
                <mlu>
                  <lu>
                    <clip pos="1" side="tl" part="lemh"/>
                    <clip pos="1" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                  </lu>
                  <lu>
                    <clip pos="2" side="tl" part="whole"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                </mlu>
              </chunk>
            </out>
            <call-macro n="f_bcond"><with-param pos="1"/><with-param pos="2"/></call-macro>
          </when>
          <otherwise>
            <out>
              <chunk namefrom="lemma" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="sl" part="temps"/></tag>
                </tags>
                <lu>
                  <clip pos="1" side="tl" part="lemh"/>
                  <clip pos="1" side="tl" part="a_verb"/>
                  <clip pos="1" side="tl" part="temps"/>
                  <clip pos="1" side="tl" part="lemq"/>
                </lu>
                <b pos="1"/>
                <lu>
                  <clip pos="2" side="tl" part="whole"/>
                </lu>
              </chunk>
            </out>
          </otherwise>
        </choose>
      </action>
    </rule>

    <rule comment="REGLA: ger">
      <pattern>
        <pattern-item n="ger"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="bisognare prnenc (eliminem els prnenc)">
      <pattern>
        <pattern-item n="bisognare"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <!--<call-macro n="tipus_verb">
          <with-param pos="1"/>
        </call-macro>-->
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
              <!--<tag><var n="tipusverb"/></tag>
              <tag><var n="cv_verb"/></tag>-->
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="bisognare prnenc prnenc (eliminem els prnenc)">
      <pattern>
        <pattern-item n="bisognare"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <!--<call-macro n="tipus_verb">
          <with-param pos="1"/>
        </call-macro>-->
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
              <!--<tag><var n="tipusverb"/></tag>
              <tag><var n="cv_verb"/></tag>-->
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
            </lu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="ger prnenc">
      <pattern>
        <pattern-item n="ger"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <!--<call-macro n="tipus_verb">
          <with-param pos="1"/>
        </call-macro>-->
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
              <!--<tag><var n="tipusverb"/></tag>
              <tag><var n="cv_verb"/></tag>-->
            </tags>
            <mlu>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
              </lu>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
            </mlu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>
    
    <rule comment="ger prnenc prnenc">
      <pattern>
        <pattern-item n="ger"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="3"/>
        </call-macro>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <choose>
          <when>
            <test>
              <and>
                <equal><clip pos="2" side="sl" part="lem"/><lit v="ci"/></equal>
                <equal><clip pos="2" side="sl" part="tipus_prn"/><lit-tag v="prn.enc.adv"/></equal>
                <equal><clip pos="3" side="sl" part="lem"/><lit v="ne"/></equal>
              </and>
            </test>
            <out>
              <chunk namefrom="lemma" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="sl" part="temps"/></tag>
                </tags>
                <mlu>
                  <lu>
                    <clip pos="1" side="tl" part="lemh"/>
                    <clip pos="1" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                  </lu>
                  <lu>
                    <clip pos="3" side="tl" part="whole"/>
                  </lu>
                  <lu>
                    <clip pos="2" side="tl" part="whole"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                </mlu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk namefrom="lemma" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="sl" part="temps"/></tag>
                </tags>
                <mlu>
                  <lu>
                    <clip pos="1" side="tl" part="lemh"/>
                    <clip pos="1" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                  </lu>
                  <lu>
                    <clip pos="2" side="tl" part="whole"/>
                  </lu>
                  <lu>
                    <clip pos="3" side="tl" part="whole"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                </mlu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>


    <rule comment="imp prnenc">
      <pattern>
        <pattern-item n="imp"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <!--<call-macro n="tipus_verb">
          <with-param pos="1"/>
        </call-macro>-->
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
              <tag><clip pos="1" side="tl" part="pers"/></tag>
              <tag><clip pos="1" side="tl" part="nbr"/></tag>
              <!--<tag><var n="tipusverb"/></tag>
              <tag><var n="cv_verb"/></tag>-->
            </tags>
            <mlu>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
                <clip pos="1" side="tl" part="pers"/>
                <clip pos="1" side="tl" part="nbr"/>
              </lu>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
            </mlu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="imp prnenc prnenc">
      <pattern>
        <pattern-item n="imp"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <!--<call-macro n="tipus_verb">
          <with-param pos="1"/>
        </call-macro>-->
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <choose>
          <when>
            <test>
              <and>
                <equal><clip pos="2" side="sl" part="lem"/><lit v="ci"/></equal>
                <equal><clip pos="2" side="sl" part="tipus_prn"/><lit-tag v="prn.enc.adv"/></equal>
                <equal><clip pos="3" side="sl" part="lem"/><lit v="ne"/></equal>
              </and>
            </test>
            <out>
              <chunk namefrom="lemma" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="sl" part="temps"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                  <!--<tag><var n="tipusverb"/></tag>
                  <tag><var n="cv_verb"/></tag>-->
                </tags>
                <mlu>
                  <lu>
                    <clip pos="1" side="tl" part="lemh"/>
                    <clip pos="1" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="pers"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <lu>
                    <clip pos="3" side="tl" part="whole"/>
                  </lu>
                  <lu>
                    <clip pos="2" side="tl" part="whole"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                </mlu>
              </chunk>
            </out>
          </when>
          <otherwise>
            <out>
              <chunk namefrom="lemma" case="caseFirstWord">
                <tags>
                  <tag><lit-tag v="SV"/></tag>
                  <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                  <tag><clip pos="1" side="sl" part="temps"/></tag>
                  <tag><clip pos="1" side="tl" part="pers"/></tag>
                  <tag><clip pos="1" side="tl" part="nbr"/></tag>
                  <!--<tag><var n="tipusverb"/></tag>
                  <tag><var n="cv_verb"/></tag>-->
                </tags>
                <mlu>
                  <lu>
                    <clip pos="1" side="tl" part="lemh"/>
                    <clip pos="1" side="tl" part="a_verb"/>
                    <clip pos="1" side="tl" part="temps"/>
                    <clip pos="1" side="tl" part="pers"/>
                    <clip pos="1" side="tl" part="nbr"/>
                  </lu>
                  <lu>
                    <clip pos="2" side="tl" part="whole"/>
                  </lu>
                  <lu>
                    <clip pos="3" side="tl" part="whole"/>
                    <clip pos="1" side="tl" part="lemq"/>
                  </lu>
                </mlu>
              </chunk>
            </out>
          </otherwise>
        </choose>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="inf prnenc">
      <pattern>
        <pattern-item n="inf"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="f_concord1">
          <with-param pos="2"/>
        </call-macro>
        <!--<call-macro n="tipus_verb">
          <with-param pos="1"/>
        </call-macro>-->
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk namefrom="lemma" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SV"/></tag>
              <tag><clip pos="1" side="tl" part="a_verb"/></tag>
              <tag><clip pos="1" side="sl" part="temps"/></tag>
              <!--<tag><var n="tipusverb"/></tag>
              <tag><var n="cv_verb"/></tag>-->
            </tags>
            <mlu>
              <lu>
                <clip pos="1" side="tl" part="lemh"/>
                <clip pos="1" side="tl" part="a_verb"/>
                <clip pos="1" side="tl" part="temps"/>
              </lu>
              <lu>
                <clip pos="2" side="tl" part="whole"/>
                <clip pos="1" side="tl" part="lemq"/>
              </lu>
            </mlu>
          </chunk>
        </out>
        <let>
          <var n="caseFirstWord"/>
          <lit v="aa"/>
        </let>
      </action>
    </rule>

    <rule comment="inf prnenc prnenc">
      <pattern>
        <pattern-item n="inf"/>
          <pattern-item n="prnenc"/>
          <pattern-item n="prnenc"/>
        </pattern>
        <action>
          <call-macro n="f_concord1">
            <with-param pos="2"/>
          </call-macro>
          <!--<call-macro n="tipus_verb">
            <with-param pos="1"/>
          </call-macro>-->
          <call-macro n="firstWord">
            <with-param pos="1"/>
          </call-macro>
          <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
          <choose>
            <when>
              <test>
                <and>
                  <equal><clip pos="2" side="sl" part="lem"/><lit v="ci"/></equal>
                  <equal><clip pos="2" side="sl" part="tipus_prn"/><lit-tag v="prn.enc.adv"/></equal>
                  <equal><clip pos="3" side="sl" part="lem"/><lit v="ne"/></equal>
                </and>
              </test>
              <out>
                <chunk namefrom="lemma" case="caseFirstWord">
                  <tags>
                    <tag><lit-tag v="SV"/></tag>
                    <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                    <tag><clip pos="1" side="sl" part="temps"/></tag>
                    <!--<tag><var n="tipusverb"/></tag>
                    <tag><var n="cv_verb"/></tag>-->
                  </tags>
                  <mlu>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="temps"/>
                    </lu>
                    <lu>
                      <clip pos="3" side="tl" part="whole"/>
                    </lu>
                    <lu>
                      <clip pos="2" side="tl" part="whole"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                  </mlu>
                </chunk>
              </out>
            </when>
            <otherwise>
              <out>
                <chunk namefrom="lemma" case="caseFirstWord">
                  <tags>
                    <tag><lit-tag v="SV"/></tag>
                    <tag><clip pos="1" side="tl" part="a_verb"/></tag>
                    <tag><clip pos="1" side="sl" part="temps"/></tag>
                    <!--<tag><var n="tipusverb"/></tag>
                    <tag><var n="cv_verb"/></tag>-->
                  </tags>
                  <mlu>
                    <lu>
                      <clip pos="1" side="tl" part="lemh"/>
                      <clip pos="1" side="tl" part="a_verb"/>
                      <clip pos="1" side="tl" part="temps"/>
                    </lu>
                    <lu>
                      <clip pos="2" side="tl" part="whole"/>
                    </lu>
                    <lu>
                      <clip pos="3" side="tl" part="whole"/>
                      <clip pos="1" side="tl" part="lemq"/>
                    </lu>
                  </mlu>
                </chunk>
              </out>
            </otherwise>
          </choose>
          <let>
            <var n="caseFirstWord"/>
            <lit v="aa"/>
          </let>
        </action>
      </rule>

    <rule comment="REGLA: pp prnenc > pp (sposatosi > casat)">
      <pattern>
        <pattern-item n="pp"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk name="pp" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SA"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

    <rule comment="REGLA: pp prnenc prnenc > pp (sposatosi > casat)">
      <pattern>
        <pattern-item n="pp"/>
        <pattern-item n="prnenc"/>
        <pattern-item n="prnenc"/>
      </pattern>
      <action>
        <call-macro n="firstWord">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_chunk_tags">
          <with-param pos="1"/>
        </call-macro>
        <call-macro n="f_concord1">
          <with-param pos="1"/>
        </call-macro>
        <let><var n="lemma"/><clip pos="1" side="tl" part="lem"/></let>
        <out>
          <chunk name="pp" case="caseFirstWord">
            <tags>
              <tag><lit-tag v="SA"/></tag>
              <tag><var n="genero"/></tag>
              <tag><var n="numero"/></tag>
              <tag><var n="genero_sl"/></tag>
              <tag><var n="numero_sl"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="lemh"/>
              <clip pos="1" side="tl" part="a_verb"/>
              <clip pos="1" side="tl" part="temps"/>
              <clip pos="1" side="tl" part="gen_sense_mf" link-to="2"/>
              <clip pos="1" side="tl" part="gen_mf"/>
              <clip pos="1" side="tl" part="nbr_sense_sp" link-to="3"/>
              <clip pos="1" side="tl" part="nbr_sp"/>
              <clip pos="1" side="tl" part="lemq"/>
            </lu>
          </chunk>
        </out>
      </action>
    </rule>

  <!-- REGLES hi ha -->

  <rule comment="regla: c'è, ci sono > hi ha (tots els temps simples)">
    <pattern>
      <pattern-item n="ci"/>
      <pattern-item n="ser_p3_no_ifi"/>
    </pattern>
    <action>
      <call-macro n="f_concord1">
        <with-param pos="2"/>
      </call-macro>
      <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vaux"/></let>
      <out>
        <chunk name="hi_ha">
          <tags>
            <tag><lit-tag v="SV"/></tag>
            <tag><clip pos="2" side="tl" part="a_verb"/></tag>
            <tag><clip pos="2" side="tl" part="temps"/></tag>
            <tag><var n="numero"/></tag>
          </tags>
          <lu>
            <get-case-from pos="1">
              <lit v="hi"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="haver"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <clip pos="2" side="tl" part="temps"/>
            <clip pos="2" side="tl" part="pers"/>
            <lit-tag v="sg"/>
            <clip pos="2" side="tl" part="lemq"/>
          </lu>
        </chunk>
      </out>
    </action>
  </rule>

  <rule comment="regla: ci fu > hi va haver">
    <pattern>
    <pattern-item n="ci"/>
    <pattern-item n="ser_p3_ifi"/>
    </pattern>
    <action>
      <let><clip pos="2" side="tl" part="a_verb"/><lit-tag v="vaux"/></let>
      <out>
        <chunk name="hi_va_haver">
          <tags>
            <tag><lit-tag v="SV"/></tag>
            <tag><clip pos="2" side="tl" part="a_verb"/></tag>
            <tag><clip pos="2" side="tl" part="temps"/></tag>
            <tag><var n="numero"/></tag>
          </tags>
          <lu>
            <get-case-from pos="1">
              <lit v="hi"/>
            </get-case-from>
            <clip pos="1" side="tl" part="tags"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="anar"/>
            </get-case-from>
            <lit-tag v="vaux"/>
            <clip pos="2" side="tl" part="pers"/>
            <lit-tag v="sg"/>
          </lu>
          <b pos="1"/>
          <lu>
            <get-case-from pos="2">
              <lit v="haver"/>
            </get-case-from>
            <clip pos="2" side="tl" part="a_verb"/>
            <lit-tag v="inf"/>
          </lu>
        </chunk>
      </out>
    </action>
  </rule>

  <!-- fi REGLES hi ha -->

  <rule comment="regla: final de frase: reset de variables">
     <pattern>
       <pattern-item n="final_sent"/>
     </pattern>
     <action>
      <let> <var n="genero"/><lit-tag v="m"/></let>
      <let> <var n="numero"/><lit-tag v="sg"/></let>
      <let> <var n="EOS"/><lit v="false"/></let>
        <out>
          <chunk name="sent">
            <tags>
              <tag><lit-tag v="sent"/></tag>
            </tags>
            <lu>
              <clip pos="1" side="tl" part="whole"/> 
            </lu>
          </chunk>
        </out>
     </action>
  </rule>

  </section-rules>
</transfer>
